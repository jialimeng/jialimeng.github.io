<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Hello World</title>
    <url>/2020/07/13/hello-world/</url>
    <content><![CDATA[<p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/one-command-deployment.html" target="_blank" rel="noopener">Deployment</a></p>
]]></content>
  </entry>
  <entry>
    <title>Hexo - 记录一次Pages服务部署失败的原因</title>
    <url>/2020/05/07/%E5%B7%A5%E5%85%B7/hexo/Hexo%20-%20%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1Pages%E6%9C%8D%E5%8A%A1%E9%83%A8%E7%BD%B2%E5%A4%B1%E8%B4%A5%E7%9A%84%E5%8E%9F%E5%9B%A0(%E8%BD%AC%E8%BD%BD)/</url>
    <content><![CDATA[<p><strong>转载</strong><a href="https://www.cnblogs.com/yulinlewis/p/10777296.html" target="_blank" rel="noopener">Hexo - 记录一次Pages服务部署失败的原因 </a></p>
<h1 id="Hexo-记录一次Pages服务部署失败的原因"><a href="#Hexo-记录一次Pages服务部署失败的原因" class="headerlink" title="Hexo - 记录一次Pages服务部署失败的原因"></a>Hexo - 记录一次Pages服务部署失败的原因</h1><h2 id="问题与分析"><a href="#问题与分析" class="headerlink" title="问题与分析"></a>问题与分析</h2><p>某天忽然发现，一直运行得好好的Pages服务部署失败了，GitHub Pages报错如下：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Your site is having problems building: The tag cq on line 3 in source&#x2F;high&#x2F;index.md is not a recognized Liquid tag.</span><br><span class="line">For more information, see https:&#x2F;&#x2F;help.github.com&#x2F;articles&#x2F;page-build-failed-unknown-tag-error&#x2F;.</span><br></pre></td></tr></table></figure>

<p>与此同时，Coding Pages同样也报错了：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Starting jekyll build.</span><br><span class="line">&gt; jekyll build --safe</span><br><span class="line">Configuration file: &#x2F;usr&#x2F;src&#x2F;app&#x2F;_config.yml</span><br><span class="line">jekyll 3.6.2 | Error:  The next theme could not be found.</span><br><span class="line">Jekyll build exit with code 1.</span><br><span class="line">Fail to build jekyll site.</span><br></pre></td></tr></table></figure>

<p>首先我使用的是Hexo的next主题，而根据GitHub Pages的报错信息来看，是说在source/high/index.md里使用到了一个不认识的cq标签。<br>这个标签是next主题自带的，使用该标签快一年了，还是第一次遇到报这个错。接着根据Coding Pages的报错来看，则是说/usr/src/app/_config.yml里找不到jekyll的主题。<br>这就很奇怪了，我使用的明明是hexo，怎么忽然就变成jekyll了？一阵瞎折腾过后，一直部署失败。我忽然想起来一个事情，我之前曾经拿本地的博客仓库的git配置练过手，难道和这个有关？<br>我开始查找本地博客仓库的git配置，我是使用hexo-deployer-git这个插件来将本地生成的静态博客发送到远程仓库的。<br>当我在本地在执行hexo g后，会在博客根目录下生成一个public文件夹，这个文件夹里的文件组合起来就是一个完整的静态博客。<br>接着如果执行hexo d，就会把这个public文件夹的东西完完整整拷贝到.deploy_git文件夹里，然后会把该文件夹里的所有文件全部推送push到远程库。之后会触发Pages服务的钩子去build项目，然后部署到网站上。</p>
<h2 id="发现线索"><a href="#发现线索" class="headerlink" title="发现线索"></a>发现线索</h2><p>我打开public文件夹，发现生成出来的文件很正常，接着打开.deploy_git文件夹，发现也很正常，接着查看远程库里的文件，终于发现了问题。<br>在远程库的分支里，根本就没有hexo相关的文件，至此算是找到原因了。<br>很显然，我在执行hexo d时出了问题，没能正常将文件push到远程库，于是部署就失败了。之前该命令是没问题的，可之前我曾经动过手脚，修改过博客项目里的git配置，手动修改了.git里的文件，莫非这就是问题的根源？</p>
<h2 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h2><p>基于以上的猜想，我直接删掉了本地博客项目的.deploy_git文件夹，重新执行命令：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">hexo cl</span><br><span class="line">hexo g -d</span><br></pre></td></tr></table></figure>

<p>等待片刻后，我终于看到远程部署成功，我的个人站点再次运转成功！<br>皇天不负有心人啊！原因终于明了，是.deploy_git文件夹出现问题，删掉该文件夹，重新运行hexo d即可。<br>记录下这次的遭遇，遇到问题应该静下心来，仔细分析，才不容易瞎折腾</p>
]]></content>
      <categories>
        <category>工具</category>
        <category>Hexo</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>Hexo博客迁移</title>
    <url>/2020/07/13/%E5%B7%A5%E5%85%B7/hexo/Hexo%E5%8D%9A%E5%AE%A2%E8%BF%81%E7%A7%BB/</url>
    <content><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>花了很多时间搭建好github+hexo博客，为了方便在另一台电脑使用已经搭建好的博客，那么，如何把Hexo博客迁移到另一台电脑？本文，整理hexo博客迁移过程。</p>
<p>两种方便的备份方法：</p>
<ul>
<li>微软的oneDrive网盘</li>
<li>利用github分支</li>
</ul>
<p>本文，整理如何在Hexo博客系统创建分支，进行备份。</p>
<h2 id="创建分支"><a href="#创建分支" class="headerlink" title="创建分支"></a>创建分支</h2><p>1、拷贝博客系统</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">克隆博客</span><br></pre></td></tr></table></figure>

<p>2、删除除了<strong>.git</strong>文件夹（历史的版本控制记录在.git文件中）的其它所有文件和文件夹。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">rm -r *</span><br></pre></td></tr></table></figure>

<p>3、把下面文件拷贝到hexo文件夹中：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">scaffolds</span><br><span class="line">source</span><br><span class="line">themes</span><br><span class="line">.git</span><br><span class="line">.gitignore</span><br><span class="line">_config.yml</span><br><span class="line">package.json</span><br></pre></td></tr></table></figure>

<p>注释：</p>
<ul>
<li>public 文件夹不需要备份，因为执行hexo g 会产生该文件</li>
<li>node_modules和package-lock.json不需要备份，因为npm install hexo-deployer-git –save 会产生这两个文件。</li>
<li>.deploy_git文件夹是 hexo d 时候产生，所以也不需要备份</li>
</ul>
<p>4、还需要删除主题文件中的.git和.github</p>
<ul>
<li>将themes目录以内中的主题的.git目录删除（如果有），因为一个git仓库中不能包含另一个git仓库，否则提交主题文件夹会失败.</li>
<li>c的。可能有人会问，删除了themes目录中的.git不就不能git pull更新主题了吗，很简单，需要更新主题时在另一个地方git clone下来该主题的最新版本，然后将内容拷到当前主题目录即可</li>
</ul>
<p>5、创建source分支，并提交</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git checkout -b source</span><br><span class="line">git add .</span><br><span class="line">git commit -a -m &quot;创建分支&quot;</span><br></pre></td></tr></table></figure>

<p>6、最好，推送分支</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git push origin source</span><br></pre></td></tr></table></figure>

<p><strong>注意：</strong></p>
<p>由于package-lock.json没做备份，当重新执行npm install hexo-deployer-git –save，会产生新的node_modules和package-lock.json文件，这时候执行hexo g，会报如下错误</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ERROR Local hexo not found in D:\hexo</span><br><span class="line">ERROR Try running:&#39;npm install hexo --save&#39;</span><br></pre></td></tr></table></figure>

<p>解决办法：</p>
<p>方法一：</p>
<p>刚开始做备份分支时候，把package-lock.json拷贝进去。</p>
<p>方法二：</p>
<p>执行下面的命令，重新更新文件包，就可以。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npm install</span><br></pre></td></tr></table></figure>

<h2 id="博客系统管理"><a href="#博客系统管理" class="headerlink" title="博客系统管理"></a>博客系统管理</h2><p>现在需要管理源码分支和gitpage博客。那么，如何管理呢？</p>
<p>1、针对原来的源码库管理</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">把source分支中的.git拷贝到原来的源码博客系统myblog目录中</span><br></pre></td></tr></table></figure>

<p><img src="http://jiali.clouddn.com/20200714_001.png" alt="20200714_001"></p>
<p>打开bash，进入myblog,可以看到已经纳入source版本控制</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">MINGW64 &#x2F;e&#x2F;myblog (source)</span><br><span class="line">$</span><br></pre></td></tr></table></figure>

<p>接下来就是推送源码到source分支和推送静态博客到master</p>
<p>推送源码到source分支</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ hexo new test</span><br><span class="line">$ git add .</span><br><span class="line">$ git commit -a -m &quot;创建test&quot;</span><br><span class="line">$ git push origin source</span><br></pre></td></tr></table></figure>

<p>推送静态博客到master分支</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">hexo g</span><br><span class="line">hexo d</span><br></pre></td></tr></table></figure>

<p>2、拉取source分支到另一台电脑,操作工程如下</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">name@DESKTOP-xx MINGW64 &#x2F;e</span><br><span class="line">$ git clone https:&#x2F;&#x2F;github.com&#x2F;xxx&#x2F;xxx.github.io.git 12</span><br><span class="line">Cloning into &#39;12&#39;...</span><br><span class="line">remote: Enumerating objects: 523, done.</span><br><span class="line">remote: Counting objects: 100% (523&#x2F;523), done.</span><br><span class="line">remote: Compressing objects: 100% (435&#x2F;435), done.</span><br><span class="line">remote: Total 523 (delta 47), reused 519 (delta 43), pack-reused 0</span><br><span class="line">Receiving objects: 100% (523&#x2F;523), 971.48 KiB | 993.00 KiB&#x2F;s, done.</span><br><span class="line">Resolving deltas: 100% (47&#x2F;47), done.</span><br><span class="line"></span><br><span class="line">name@DESKTOP-xx MINGW64 &#x2F;e</span><br><span class="line">$ cd 12</span><br><span class="line"></span><br><span class="line">name@DESKTOP-xx MINGW64 &#x2F;e&#x2F;12 (source)</span><br><span class="line">$ ls</span><br><span class="line">_config.yml  package.json  scaffolds&#x2F;  source&#x2F;  themes&#x2F;</span><br><span class="line"></span><br><span class="line">name@DESKTOP-xx MINGW64 &#x2F;e&#x2F;12 (source)</span><br><span class="line">$ ls -a</span><br><span class="line">.&#x2F;   .git&#x2F;       _config.yml   scaffolds&#x2F;  themes&#x2F;</span><br><span class="line">..&#x2F;  .gitignore  package.json  source&#x2F;</span><br><span class="line"></span><br><span class="line">name@DESKTOP-xx MINGW64 &#x2F;e&#x2F;12 (source)</span><br><span class="line">$ npm install</span><br><span class="line"></span><br><span class="line">&gt; ejs@2.7.4 postinstall E:\12\node_modules\ejs</span><br><span class="line">&gt; node .&#x2F;postinstall.js</span><br><span class="line"></span><br><span class="line">Thank you for installing EJS: built with the Jake JavaScript build tool (https:&#x2F;&#x2F;jakejs.com&#x2F;)</span><br><span class="line"></span><br><span class="line">npm notice created a lockfile as package-lock.json. You should commit this file.</span><br><span class="line">npm WARN optional SKIPPING OPTIONAL DEPENDENCY: fsevents@2.1.3 (node_modules\fsevents):</span><br><span class="line">npm WARN notsup SKIPPING OPTIONAL DEPENDENCY: Unsupported platform for fsevents@2.1.3: wanted &#123;&quot;os&quot;:&quot;darwin&quot;,&quot;arch&quot;:&quot;any&quot;&#125; (current: &#123;&quot;os&quot;:&quot;win32&quot;,&quot;arch&quot;:&quot;x64&quot;&#125;)</span><br><span class="line"></span><br><span class="line">added 254 packages in 40.502s</span><br><span class="line"></span><br><span class="line">name@DESKTOP-xx MINGW64 &#x2F;e&#x2F;12 (source)</span><br><span class="line">$ npm install hexo-deployer-git --save</span><br><span class="line">npm WARN optional SKIPPING OPTIONAL DEPENDENCY: fsevents@2.1.3 (node_modules\fsevents):</span><br><span class="line">npm WARN notsup SKIPPING OPTIONAL DEPENDENCY: Unsupported platform for fsevents@2.1.3: wanted &#123;&quot;os&quot;:&quot;darwin&quot;,&quot;arch&quot;:&quot;any&quot;&#125; (current: &#123;&quot;os&quot;:&quot;win32&quot;,&quot;arch&quot;:&quot;x64&quot;&#125;)</span><br><span class="line"></span><br><span class="line">+ hexo-deployer-git@2.1.0</span><br><span class="line">updated 1 package in 1.458s</span><br><span class="line"></span><br><span class="line">name@DESKTOP-xx MINGW64 &#x2F;e&#x2F;12 (source)</span><br><span class="line">$ ls</span><br><span class="line">_config.yml    package.json       scaffolds&#x2F;  themes&#x2F;</span><br><span class="line">node_modules&#x2F;  package-lock.json  source&#x2F;</span><br><span class="line"></span><br><span class="line">name@DESKTOP-xx MINGW64 &#x2F;e&#x2F;12 (source)</span><br><span class="line">$ git status</span><br><span class="line">On branch source</span><br><span class="line">Your branch is up to date with &#39;origin&#x2F;source&#39;.</span><br><span class="line"></span><br><span class="line">Changes not staged for commit:</span><br><span class="line">  (use &quot;git add &lt;file&gt;...&quot; to update what will be committed)</span><br><span class="line">  (use &quot;git restore &lt;file&gt;...&quot; to discard changes in working directory)</span><br><span class="line">        modified:   package.json</span><br><span class="line"></span><br><span class="line">no changes added to commit (use &quot;git add&quot; and&#x2F;or &quot;git commit -a&quot;)</span><br><span class="line"></span><br><span class="line">name@DESKTOP-xx MINGW64 &#x2F;e&#x2F;12 (source)</span><br><span class="line">$ git restore package.json</span><br><span class="line"></span><br><span class="line">name@DESKTOP-xx MINGW64 &#x2F;e&#x2F;12 (source)</span><br><span class="line">$ git status</span><br><span class="line">On branch source</span><br><span class="line">Your branch is up to date with &#39;origin&#x2F;source&#39;.</span><br><span class="line"></span><br><span class="line">nothing to commit, working tree clean</span><br><span class="line"></span><br><span class="line">name@DESKTOP-xx MINGW64 &#x2F;e&#x2F;12 (source)</span><br><span class="line">$ hexo new test</span><br><span class="line">INFO  Created: E:\12\source\_posts\test.md</span><br><span class="line"></span><br><span class="line">name@DESKTOP-xx MINGW64 &#x2F;e&#x2F;12 (source)</span><br><span class="line">$ ls -a</span><br><span class="line">.&#x2F;   .git&#x2F;       _config.yml    package.json       scaffolds&#x2F;  themes&#x2F;</span><br><span class="line">..&#x2F;  .gitignore  node_modules&#x2F;  package-lock.json  source&#x2F;</span><br><span class="line"></span><br><span class="line">name@DESKTOP-xx MINGW64 &#x2F;e&#x2F;12 (source)</span><br><span class="line">$ hexo g</span><br><span class="line">INFO  Start processing</span><br><span class="line">INFO  Files loaded in 303 ms</span><br><span class="line">INFO  Generated: search.xml</span><br><span class="line">INFO  Generated: index.html</span><br><span class="line">INFO  Generated: categories&#x2F;index.html</span><br><span class="line">INFO  Generated: about&#x2F;index.html</span><br><span class="line">INFO  Generated: archives&#x2F;index.html</span><br><span class="line">INFO  Generated: tags&#x2F;index.html</span><br><span class="line">INFO  Generated: images&#x2F;avatar.gif</span><br><span class="line">INFO  Generated: images&#x2F;apple-touch-icon-next.png</span><br><span class="line">INFO  Generated: images&#x2F;algolia_logo.svg</span><br><span class="line">INFO  Generated: images&#x2F;cc-by-nc.svg</span><br><span class="line">INFO  Generated: images&#x2F;cc-by-nc-nd.svg</span><br><span class="line">INFO  Generated: images&#x2F;cc-by-nc-sa.svg</span><br><span class="line">INFO  Generated: images&#x2F;cc-by-nd.svg</span><br><span class="line">INFO  Generated: images&#x2F;cc-by-sa.svg</span><br><span class="line">INFO  Generated: images&#x2F;logo.svg</span><br><span class="line">INFO  Generated: images&#x2F;cc-by.svg</span><br><span class="line">INFO  Generated: images&#x2F;cc-zero.svg</span><br><span class="line">INFO  Generated: images&#x2F;favicon-16x16-next.png</span><br><span class="line">INFO  Generated: images&#x2F;favicon-32x32-next.png</span><br><span class="line">INFO  Generated: archives&#x2F;2020&#x2F;index.html</span><br><span class="line">INFO  Generated: archives&#x2F;2020&#x2F;07&#x2F;index.html</span><br><span class="line">INFO  Generated: js&#x2F;algolia-search.js</span><br><span class="line">INFO  Generated: js&#x2F;bookmark.js</span><br><span class="line">INFO  Generated: css&#x2F;main.css</span><br><span class="line">INFO  Generated: js&#x2F;next-boot.js</span><br><span class="line">INFO  Generated: lib&#x2F;anime.min.js</span><br><span class="line">INFO  Generated: js&#x2F;motion.js</span><br><span class="line">INFO  Generated: js&#x2F;local-search.js</span><br><span class="line">INFO  Generated: js&#x2F;utils.js</span><br><span class="line">INFO  Generated: lib&#x2F;velocity&#x2F;velocity.ui.min.js</span><br><span class="line">INFO  Generated: js&#x2F;schemes&#x2F;muse.js</span><br><span class="line">INFO  Generated: lib&#x2F;velocity&#x2F;velocity.min.js</span><br><span class="line">INFO  Generated: js&#x2F;schemes&#x2F;pisces.js</span><br><span class="line">INFO  Generated: lib&#x2F;font-awesome&#x2F;css&#x2F;all.min.css</span><br><span class="line">INFO  Generated: 2020&#x2F;07&#x2F;14&#x2F;hello-world&#x2F;index.html</span><br><span class="line">INFO  Generated: 2020&#x2F;07&#x2F;14&#x2F;test&#x2F;index.html</span><br><span class="line">INFO  Generated: lib&#x2F;font-awesome&#x2F;webfonts&#x2F;fa-regular-400.woff2</span><br><span class="line">INFO  Generated: lib&#x2F;font-awesome&#x2F;webfonts&#x2F;fa-solid-900.woff2</span><br><span class="line">INFO  Generated: lib&#x2F;font-awesome&#x2F;webfonts&#x2F;fa-brands-400.woff2</span><br><span class="line">INFO  39 files generated in 689 ms</span><br><span class="line"></span><br><span class="line">name@DESKTOP-xx MINGW64 &#x2F;e&#x2F;12 (source)</span><br><span class="line">$ ls</span><br><span class="line">_config.yml  node_modules&#x2F;  package-lock.json  scaffolds&#x2F;  themes&#x2F;</span><br><span class="line">db.json      package.json   public&#x2F;            source&#x2F;</span><br><span class="line"></span><br><span class="line">name@DESKTOP-xx MINGW64 &#x2F;e&#x2F;12 (source)</span><br><span class="line">$ hexo s</span><br><span class="line">INFO  Start processing</span><br><span class="line">INFO  Hexo is running at http:&#x2F;&#x2F;localhost:4000 . Press Ctrl+C to stop.</span><br><span class="line">INFO  Farewell</span><br><span class="line"></span><br><span class="line">name@DESKTOP-xx MINGW64 &#x2F;e&#x2F;12 (source)</span><br><span class="line">$ ls</span><br><span class="line">_config.yml  node_modules&#x2F;  package-lock.json  scaffolds&#x2F;  themes&#x2F;</span><br><span class="line">db.json      package.json   public&#x2F;            source&#x2F;</span><br><span class="line"></span><br><span class="line">name@DESKTOP-xx MINGW64 &#x2F;e&#x2F;12 (source)</span><br><span class="line">$ git status</span><br><span class="line">On branch source</span><br><span class="line">Your branch is up to date with &#39;origin&#x2F;source&#39;.</span><br><span class="line"></span><br><span class="line">Untracked files:</span><br><span class="line">  (use &quot;git add &lt;file&gt;...&quot; to include in what will be committed)</span><br><span class="line">        source&#x2F;_posts&#x2F;test.md</span><br><span class="line"></span><br><span class="line">nothing added to commit but untracked files present (use &quot;git add&quot; to track)</span><br><span class="line"></span><br><span class="line">name@DESKTOP-xx MINGW64 &#x2F;e&#x2F;12 (source)</span><br><span class="line">$ git add source&#x2F;_posts&#x2F;test.md</span><br><span class="line">warning: LF will be replaced by CRLF in source&#x2F;_posts&#x2F;test.md.</span><br><span class="line">The file will have its original line endings in your working directory</span><br><span class="line"></span><br><span class="line">name@DESKTOP-xx MINGW64 &#x2F;e&#x2F;12 (source)</span><br><span class="line">$ git status</span><br><span class="line">On branch source</span><br><span class="line">Your branch is up to date with &#39;origin&#x2F;source&#39;.</span><br><span class="line"></span><br><span class="line">Changes to be committed:</span><br><span class="line">  (use &quot;git restore --staged &lt;file&gt;...&quot; to unstage)</span><br><span class="line">        new file:   source&#x2F;_posts&#x2F;test.md</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">name@DESKTOP-xx MINGW64 &#x2F;e&#x2F;12 (source)</span><br><span class="line">$ git commit -a -m &quot;提交git 测试文件&quot;</span><br><span class="line">[source 5df4335] 提交git 测试文件</span><br><span class="line"> 1 file changed, 7 insertions(+)</span><br><span class="line"> create mode 100644 source&#x2F;_posts&#x2F;test.md</span><br><span class="line"></span><br><span class="line">name@DESKTOP-xx MINGW64 &#x2F;e&#x2F;12 (source)</span><br><span class="line">$ git push origin source</span><br><span class="line">Enumerating objects: 8, done.</span><br><span class="line">Counting objects: 100% (8&#x2F;8), done.</span><br><span class="line">Delta compression using up to 4 threads</span><br><span class="line">Compressing objects: 100% (5&#x2F;5), done.</span><br><span class="line">Writing objects: 100% (5&#x2F;5), 578 bytes | 578.00 KiB&#x2F;s, done.</span><br><span class="line">Total 5 (delta 1), reused 0 (delta 0)</span><br><span class="line">remote: Resolving deltas: 100% (1&#x2F;1), completed with 1 local object.</span><br><span class="line">To https:&#x2F;&#x2F;github.com&#x2F;xxx&#x2F;xxx.github.io.git</span><br><span class="line">   10d4b36..5df4335  source -&gt; source</span><br><span class="line"></span><br><span class="line">name@DESKTOP-xx MINGW64 &#x2F;e&#x2F;12 (source)</span><br><span class="line">$ hexo d</span><br><span class="line">INFO  Deploying: git</span><br><span class="line">INFO  Setting up Git deployment...</span><br><span class="line">Initialized empty Git repository in E:&#x2F;12&#x2F;.deploy_git&#x2F;.git&#x2F;</span><br><span class="line">[master (root-commit) 4c6e408] First commit</span><br><span class="line"> 1 file changed, 0 insertions(+), 0 deletions(-)</span><br><span class="line"> create mode 100644 placeholder</span><br><span class="line">INFO  Clearing .deploy_git folder...</span><br><span class="line">INFO  Copying files from public folder...</span><br><span class="line">INFO  Copying files from extend dirs...</span><br><span class="line">warning: LF will be replaced by CRLF in 2020&#x2F;07&#x2F;14&#x2F;hello-world&#x2F;index.html.</span><br><span class="line">The file will have its original line endings in your working directory</span><br><span class="line">warning: LF will be replaced by CRLF in 2020&#x2F;07&#x2F;14&#x2F;test&#x2F;index.html.</span><br><span class="line">The file will have its original line endings in your working directory</span><br><span class="line">warning: LF will be replaced by CRLF in about&#x2F;index.html.</span><br><span class="line">The file will have its original line endings in your working directory</span><br><span class="line">warning: LF will be replaced by CRLF in archives&#x2F;2020&#x2F;07&#x2F;index.html.</span><br><span class="line">The file will have its original line endings in your working directory</span><br><span class="line">warning: LF will be replaced by CRLF in archives&#x2F;2020&#x2F;index.html.</span><br><span class="line">The file will have its original line endings in your working directory</span><br><span class="line">warning: LF will be replaced by CRLF in archives&#x2F;index.html.</span><br><span class="line">The file will have its original line endings in your working directory</span><br><span class="line">warning: LF will be replaced by CRLF in categories&#x2F;index.html.</span><br><span class="line">The file will have its original line endings in your working directory</span><br><span class="line">warning: LF will be replaced by CRLF in css&#x2F;main.css.</span><br><span class="line">The file will have its original line endings in your working directory</span><br><span class="line">warning: LF will be replaced by CRLF in index.html.</span><br><span class="line">The file will have its original line endings in your working directory</span><br><span class="line">warning: LF will be replaced by CRLF in js&#x2F;algolia-search.js.</span><br><span class="line">The file will have its original line endings in your working directory</span><br><span class="line">warning: LF will be replaced by CRLF in js&#x2F;bookmark.js.</span><br><span class="line">The file will have its original line endings in your working directory</span><br><span class="line">warning: LF will be replaced by CRLF in js&#x2F;local-search.js.</span><br><span class="line">The file will have its original line endings in your working directory</span><br><span class="line">warning: LF will be replaced by CRLF in js&#x2F;motion.js.</span><br><span class="line">The file will have its original line endings in your working directory</span><br><span class="line">warning: LF will be replaced by CRLF in js&#x2F;next-boot.js.</span><br><span class="line">The file will have its original line endings in your working directory</span><br><span class="line">warning: LF will be replaced by CRLF in js&#x2F;schemes&#x2F;muse.js.</span><br><span class="line">The file will have its original line endings in your working directory</span><br><span class="line">warning: LF will be replaced by CRLF in js&#x2F;schemes&#x2F;pisces.js.</span><br><span class="line">The file will have its original line endings in your working directory</span><br><span class="line">warning: LF will be replaced by CRLF in js&#x2F;utils.js.</span><br><span class="line">The file will have its original line endings in your working directory</span><br><span class="line">warning: LF will be replaced by CRLF in lib&#x2F;anime.min.js.</span><br><span class="line">The file will have its original line endings in your working directory</span><br><span class="line">warning: LF will be replaced by CRLF in lib&#x2F;font-awesome&#x2F;css&#x2F;all.min.css.</span><br><span class="line">The file will have its original line endings in your working directory</span><br><span class="line">warning: LF will be replaced by CRLF in lib&#x2F;velocity&#x2F;velocity.min.js.</span><br><span class="line">The file will have its original line endings in your working directory</span><br><span class="line">warning: LF will be replaced by CRLF in lib&#x2F;velocity&#x2F;velocity.ui.min.js.</span><br><span class="line">The file will have its original line endings in your working directory</span><br><span class="line">warning: LF will be replaced by CRLF in search.xml.</span><br><span class="line">The file will have its original line endings in your working directory</span><br><span class="line">warning: LF will be replaced by CRLF in tags&#x2F;index.html.</span><br><span class="line">The file will have its original line endings in your working directory</span><br><span class="line">[master 66f6452] Site updated: 2020-07-14 09:07:06</span><br><span class="line"> 40 files changed, 8653 insertions(+)</span><br><span class="line"> create mode 100644 2020&#x2F;07&#x2F;14&#x2F;hello-world&#x2F;index.html</span><br><span class="line"> create mode 100644 2020&#x2F;07&#x2F;14&#x2F;test&#x2F;index.html</span><br><span class="line"> create mode 100644 about&#x2F;index.html</span><br><span class="line"> create mode 100644 archives&#x2F;2020&#x2F;07&#x2F;index.html</span><br><span class="line"> create mode 100644 archives&#x2F;2020&#x2F;index.html</span><br><span class="line"> create mode 100644 archives&#x2F;index.html</span><br><span class="line"> create mode 100644 categories&#x2F;index.html</span><br><span class="line"> create mode 100644 css&#x2F;main.css</span><br><span class="line"> create mode 100644 images&#x2F;algolia_logo.svg</span><br><span class="line"> create mode 100644 images&#x2F;apple-touch-icon-next.png</span><br><span class="line"> create mode 100644 images&#x2F;avatar.gif</span><br><span class="line"> create mode 100644 images&#x2F;cc-by-nc-nd.svg</span><br><span class="line"> create mode 100644 images&#x2F;cc-by-nc-sa.svg</span><br><span class="line"> create mode 100644 images&#x2F;cc-by-nc.svg</span><br><span class="line"> create mode 100644 images&#x2F;cc-by-nd.svg</span><br><span class="line"> create mode 100644 images&#x2F;cc-by-sa.svg</span><br><span class="line"> create mode 100644 images&#x2F;cc-by.svg</span><br><span class="line"> create mode 100644 images&#x2F;cc-zero.svg</span><br><span class="line"> create mode 100644 images&#x2F;favicon-16x16-next.png</span><br><span class="line"> create mode 100644 images&#x2F;favicon-32x32-next.png</span><br><span class="line"> create mode 100644 images&#x2F;logo.svg</span><br><span class="line"> create mode 100644 index.html</span><br><span class="line"> create mode 100644 js&#x2F;algolia-search.js</span><br><span class="line"> create mode 100644 js&#x2F;bookmark.js</span><br><span class="line"> create mode 100644 js&#x2F;local-search.js</span><br><span class="line"> create mode 100644 js&#x2F;motion.js</span><br><span class="line"> create mode 100644 js&#x2F;next-boot.js</span><br><span class="line"> create mode 100644 js&#x2F;schemes&#x2F;muse.js</span><br><span class="line"> create mode 100644 js&#x2F;schemes&#x2F;pisces.js</span><br><span class="line"> create mode 100644 js&#x2F;utils.js</span><br><span class="line"> create mode 100644 lib&#x2F;anime.min.js</span><br><span class="line"> create mode 100644 lib&#x2F;font-awesome&#x2F;css&#x2F;all.min.css</span><br><span class="line"> create mode 100644 lib&#x2F;font-awesome&#x2F;webfonts&#x2F;fa-brands-400.woff2</span><br><span class="line"> create mode 100644 lib&#x2F;font-awesome&#x2F;webfonts&#x2F;fa-regular-400.woff2</span><br><span class="line"> create mode 100644 lib&#x2F;font-awesome&#x2F;webfonts&#x2F;fa-solid-900.woff2</span><br><span class="line"> create mode 100644 lib&#x2F;velocity&#x2F;velocity.min.js</span><br><span class="line"> create mode 100644 lib&#x2F;velocity&#x2F;velocity.ui.min.js</span><br><span class="line"> delete mode 100644 placeholder</span><br><span class="line"> create mode 100644 search.xml</span><br><span class="line"> create mode 100644 tags&#x2F;index.html</span><br><span class="line">Enumerating objects: 64, done.</span><br><span class="line">Counting objects: 100% (64&#x2F;64), done.</span><br><span class="line">Delta compression using up to 4 threads</span><br><span class="line">Compressing objects: 100% (52&#x2F;52), done.</span><br><span class="line">Writing objects: 100% (64&#x2F;64), 253.60 KiB | 9.75 MiB&#x2F;s, done.</span><br><span class="line">Total 64 (delta 13), reused 0 (delta 0)</span><br><span class="line">remote: Resolving deltas: 100% (13&#x2F;13), done.</span><br><span class="line">To https:&#x2F;&#x2F;github.com&#x2F;xxx&#x2F;xxx.github.io</span><br><span class="line"> + b15a917...66f6452 HEAD -&gt; master (forced update)</span><br><span class="line">Branch &#39;master&#39; set up to track remote branch &#39;master&#39; from &#39;https:&#x2F;&#x2F;github.com&#x2F;xxx&#x2F;xxx.github.io&#39;.</span><br><span class="line">INFO  Deploy done: git</span><br><span class="line"></span><br><span class="line">name@DESKTOP-xx MINGW64 &#x2F;e&#x2F;12 (source)</span><br><span class="line">$ ls</span><br><span class="line">_config.yml  node_modules&#x2F;  package-lock.json  scaffolds&#x2F;  themes&#x2F;</span><br><span class="line">db.json      package.json   public&#x2F;            source&#x2F;</span><br><span class="line"></span><br><span class="line">name@DESKTOP-xx MINGW64 &#x2F;e&#x2F;12 (source)</span><br><span class="line">$ ls -a</span><br><span class="line">.&#x2F;            .git&#x2F;        db.json        package-lock.json  source&#x2F;</span><br><span class="line">..&#x2F;           .gitignore   node_modules&#x2F;  public&#x2F;            themes&#x2F;</span><br><span class="line">.deploy_git&#x2F;  _config.yml  package.json   scaffolds&#x2F;</span><br><span class="line"></span><br><span class="line">name@DESKTOP-xx MINGW64 &#x2F;e&#x2F;12 (source)</span><br><span class="line">$ git pull origin source</span><br><span class="line">remote: Enumerating objects: 7, done.</span><br><span class="line">remote: Counting objects: 100% (7&#x2F;7), done.</span><br><span class="line">remote: Compressing objects: 100% (2&#x2F;2), done.</span><br><span class="line">remote: Total 4 (delta 1), reused 4 (delta 1), pack-reused 0</span><br><span class="line">Unpacking objects: 100% (4&#x2F;4), done.</span><br><span class="line">From https:&#x2F;&#x2F;github.com&#x2F;xxx&#x2F;xxx.github.io</span><br><span class="line"> * branch            source     -&gt; FETCH_HEAD</span><br><span class="line">   5df4335..dcf7612  source     -&gt; origin&#x2F;source</span><br><span class="line">Updating 5df4335..dcf7612</span><br><span class="line">Fast-forward</span><br><span class="line"> source&#x2F;_posts&#x2F;test.md | 7 -------</span><br><span class="line"> 1 file changed, 7 deletions(-)</span><br><span class="line"> delete mode 100644 source&#x2F;_posts&#x2F;test.md</span><br><span class="line"></span><br><span class="line">name@DESKTOP-xx MINGW64 &#x2F;e&#x2F;12 (source)</span><br><span class="line">$ git status</span><br><span class="line">On branch source</span><br><span class="line">Your branch is up to date with &#39;origin&#x2F;source&#39;.</span><br><span class="line"></span><br><span class="line">nothing to commit, working tree clean</span><br><span class="line"></span><br><span class="line">name@DESKTOP-xx MINGW64 &#x2F;e&#x2F;12 (source)</span><br><span class="line">$ ls source&#x2F;_posts&#x2F;</span><br><span class="line">hello-world.md</span><br><span class="line"></span><br><span class="line">name@DESKTOP-xx MINGW64 &#x2F;e&#x2F;12 (source)</span><br><span class="line">$</span><br></pre></td></tr></table></figure>

<p>参考：</p>
<p><a href="https://blog.csdn.net/White_Idiot/article/details/80685990" target="_blank" rel="noopener">【GitHub】创建Git分支将Hexo博客迁移到其它电脑</a></p>
<p><a href="https://zouhua.top/archives/a2a13e.html" target="_blank" rel="noopener">git分支保存hexo博客源码</a></p>
<p><a href="https://kernelshow.com/2018/09/02/2018/09/0002-hexo_use_branch_to_backup_your_hexo_environment_and_blogs/" target="_blank" rel="noopener">使用 Hexo 搭建 GitHub Page 博客(二)–备份至 GitHub 过程</a></p>
<p><a href="https://www.cnblogs.com/MuYunyun/p/5927491.html" target="_blank" rel="noopener">基于hexo+github搭建一个独立博客</a></p>
<p><a href="https://blog.csdn.net/yellowmushroom/article/details/80680022" target="_blank" rel="noopener">搭建Hexo博客在git上执行 hexo d /hexo g 报错:ERROR Local hexo not found in D:\hexo 解决</a></p>
]]></content>
      <categories>
        <category>工具</category>
        <category>Hexo</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>Hexo搭建博客及设置新主题</title>
    <url>/2020/05/07/%E5%B7%A5%E5%85%B7/hexo/Hexo%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2%E5%8F%8A%E8%AE%BE%E7%BD%AE%E6%96%B0%E4%B8%BB%E9%A2%98/</url>
    <content><![CDATA[<h1 id="Hexo搭建博客及设置新主题"><a href="#Hexo搭建博客及设置新主题" class="headerlink" title="Hexo搭建博客及设置新主题"></a>Hexo搭建博客及设置新主题</h1><h2 id="1-前言"><a href="#1-前言" class="headerlink" title="1 前言"></a>1 前言</h2><p>前面使用GitHub Pages和hexo搭建了博客，但是使用默认的Hexo主题，不怎么好看。因此，我网上搜了一下hexo主题，发现next主题在github上人气比较高，而且比较它的喜欢简洁的风格。本文以设置next主题为例子，介绍Hexo如何设置新主题。</p>
<h2 id="2-创建博客"><a href="#2-创建博客" class="headerlink" title="2 创建博客"></a>2 创建博客</h2><p>步骤1：</p>
<p>在E盘创建myhexo-next文件夹</p>
<p>步骤2：</p>
<p>打开window下的bash shell命令终端</p>
<p><img src="http://q9kx2gcuj.bkt.clouddn.com/20200507_001.jpg" alt="20200507_001"></p>
<p>步骤3：</p>
<p>在shell终端输入下面命令,进入myhexo-next文件夹目录</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cd myhexo-next</span><br></pre></td></tr></table></figure>

<p>步骤4：</p>
<p>执行初始化博客根目录的命令</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">hexo init</span><br></pre></td></tr></table></figure>

<p>步骤5：</p>
<p>在博客根目录安装插件，命令如下</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure>

<p>备注：</p>
<p>不需要插件可以不用安装。</p>
<p>然后，在myhexo-next目录下会有下面的内容</p>
<p><img src="http://q9kx2gcuj.bkt.clouddn.com/20200507_002.png" alt="20200507_002"></p>
<p>步骤6：</p>
<p>在myhexo-next目录下，修改_config.yml文件的deploy属性(注意:之后有空格)。</p>
<p>默认是这样：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">deploy:</span><br><span class="line">  type: &#39;&#39;</span><br></pre></td></tr></table></figure>

<p>改为</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">deploy:</span><br><span class="line">  type: git</span><br><span class="line">  repo: git@github.com:name_xxx&#x2F;name_xx.github.io.git</span><br><span class="line">  branch: master</span><br></pre></td></tr></table></figure>

<p>步骤7：</p>
<p>生成静态网页，输入下面的命令</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">hexo g</span><br></pre></td></tr></table></figure>

<p>本地预览，输入下面的命令</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">hexo s</span><br></pre></td></tr></table></figure>

<p>在浏览器中打开生成的静态网页</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;localhost:4000&#x2F;</span><br></pre></td></tr></table></figure>

<p>默认的主题：</p>
<p><img src="http://q9kx2gcuj.bkt.clouddn.com/20200507_011.png" alt="20200507_011"></p>
<p>上传github</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">hexo d</span><br></pre></td></tr></table></figure>

<p>到此，利用hexo搭建博客已经完毕。</p>
<h2 id="3-更改主题为next主题"><a href="#3-更改主题为next主题" class="headerlink" title="3 更改主题为next主题"></a>3 更改主题为next主题</h2><p>在 Hexo 中有两份主要的配置文件，其名称都是 _config.yml。 其中，一份位于博客根目录下，主要包含 Hexo 本身的配置；另一份位于主题目录下，这份配置由主题作者提供，主要用于配置主题相关的选项。为了描述方便，在以下说明中，将博客根目录下的_config.yml称为 <strong>站点配置文件</strong>， 将主题目录下的_config.yml称为 <strong>主题配置文件。</strong></p>
<h3 id="3-1-下载主题"><a href="#3-1-下载主题" class="headerlink" title="3.1 下载主题"></a>3.1 下载主题</h3><p>在shell终端窗口下，进入博客 根目录myhexo-next目录下。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cd myhexo-next</span><br></pre></td></tr></table></figure>

<p>使用 Git checkout 代码：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git clone https:&#x2F;&#x2F;github.com&#x2F;theme-next&#x2F;hexo-theme-next themes&#x2F;next</span><br></pre></td></tr></table></figure>

<p>然后进入根目录下的themes </p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cd themes</span><br></pre></td></tr></table></figure>

<p>执行</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ls</span><br></pre></td></tr></table></figure>

<p>发现themes目录下多了一个next文件夹.</p>
<p><img src="http://q9kx2gcuj.bkt.clouddn.com/20200507_003.png" alt="20200507_003"></p>
<p>进入next文件夹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cd next</span><br></pre></td></tr></table></figure>

<p>在执行</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ls</span><br></pre></td></tr></table></figure>

<p>发现next已经下载下来</p>
<p><img src="http://q9kx2gcuj.bkt.clouddn.com/20200507_004.png" alt="20200507_004"></p>
<h3 id="3-2-修改站点配置文件"><a href="#3-2-修改站点配置文件" class="headerlink" title="3.2 修改站点配置文件"></a>3.2 修改站点配置文件</h3><p>站点配置文件默认的主题配置为landscape</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># Extensions</span><br><span class="line">## Plugins: https:&#x2F;&#x2F;hexo.io&#x2F;plugins&#x2F;</span><br><span class="line">## Themes: https:&#x2F;&#x2F;hexo.io&#x2F;themes&#x2F;</span><br><span class="line">theme: landscape</span><br></pre></td></tr></table></figure>

<p>将站点配置文件的主题修改为next(<strong>注意空格</strong>)</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># Extensions</span><br><span class="line">## Plugins: https:&#x2F;&#x2F;hexo.io&#x2F;plugins&#x2F;</span><br><span class="line">## Themes: https:&#x2F;&#x2F;hexo.io&#x2F;themes&#x2F;</span><br><span class="line">theme: next</span><br></pre></td></tr></table></figure>

<h3 id="3-3-调试"><a href="#3-3-调试" class="headerlink" title="3.3 调试"></a>3.3 调试</h3><p>回到博客根目录myhexo-next</p>
<p>执行调试命令</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">hexo server --debug</span><br></pre></td></tr></table></figure>

<p>结果如下：</p>
<p><img src="http://q9kx2gcuj.bkt.clouddn.com/20200507_005.png" alt="20200507_005"></p>
<p>在浏览器输入</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;localhost:4000</span><br></pre></td></tr></table></figure>

<p>就可以看到博客了</p>
<p><img src="http://q9kx2gcuj.bkt.clouddn.com/20200507_007.png" alt="20200507_007"></p>
<p>进入next目录，修改主题配置文件的menu，默认为</p>
<p><img src="http://q9kx2gcuj.bkt.clouddn.com/20200507_008.png" alt="20200507_008"></p>
<p>改为</p>
<p><img src="http://q9kx2gcuj.bkt.clouddn.com/20200507_009.png" alt="20200507_009"></p>
<p>然后重新执行</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">hexo server --debug</span><br></pre></td></tr></table></figure>

<p>结果如下</p>
<p><img src="http://q9kx2gcuj.bkt.clouddn.com/20200507_010.png" alt="20200507_010"></p>
<p>参考：</p>
<p><a href="https://github.com/iissnan/hexo-theme-next" target="_blank" rel="noopener">next主题源代码</a></p>
<p><a href="https://github.com/theme-next/hexo-theme-next" target="_blank" rel="noopener">维护版本的next源码</a></p>
<p><a href="https://zhoubofsy.github.io/" target="_blank" rel="noopener">模板参考1</a></p>
<p><a href="https://draapho.github.io/categories/" target="_blank" rel="noopener">模板参考2</a></p>
<p><a href="https://www.jianshu.com/p/b20fc983005f" target="_blank" rel="noopener">Hexo设置主题以及Next主题个性设置</a></p>
<p><a href="https://segmentfault.com/a/1190000012805627" target="_blank" rel="noopener">如何更换hexo博客主题</a></p>
<p><a href="http://theme-next.iissnan.com/getting-started.html" target="_blank" rel="noopener">next主题官网文档</a></p>
<p><a href="https://zhuanlan.zhihu.com/p/85037898" target="_blank" rel="noopener">Hexo系列 | Hexo+next主题搭建炫酷的个人博客网站</a></p>
<p><a href="https://io-oi.me/tech/hexo-next-optimization/" target="_blank" rel="noopener">打造个性超赞博客 Hexo + NexT + GitHub Pages 的超深度优化</a></p>
]]></content>
      <categories>
        <category>工具</category>
        <category>Hexo</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>Hexo环境搭建</title>
    <url>/2019/12/10/%E5%B7%A5%E5%85%B7/hexo/Hexo%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/</url>
    <content><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>安装前提:<br>安装Node.js<br>安装Git</p>
<h2 id="安装Node-js"><a href="#安装Node-js" class="headerlink" title="安装Node.js"></a>安装Node.js</h2><p>安装选项全部默认，一路点击Next。</p>
<p>最后安装好之后，按Win+R打开命令提示符，输入node -v和npm -v，如果出现版本号，那么就安装成功了。</p>
<p><strong>更改为国内镜像源:</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npm config set registry https:&#x2F;&#x2F;registry.npm.taobao.org</span><br></pre></td></tr></table></figure>

<h2 id="安装Git"><a href="#安装Git" class="headerlink" title="安装Git"></a>安装Git</h2><p>安装选项还是全部默认，只不过最后一步添加路径时选择Use Git from the Windows Command Prompt，这样我们就可以直接在命令提示符里打开git了。</p>
<p>安装完成后在命令提示符中输入git –version验证是否安装成功。</p>
<h2 id="安装Hexo"><a href="#安装Hexo" class="headerlink" title="安装Hexo"></a>安装Hexo</h2><p>右键点击Git Bash Here，进入git shell<br>所有必备的应用程序安装完成后，即可使用 npm 安装 Hexo。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ npm install -g hexo-cli</span><br></pre></td></tr></table></figure>

<p>进阶安装和使用<br>对于熟悉 npm 的进阶用户，可以仅局部安装 hexo 包。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ npm install hexo</span><br></pre></td></tr></table></figure>

<p>安装以后，可以使用以下两种方式执行 Hexo：</p>
<p>npx hexo <command></p>
<p>将 Hexo 所在的目录下的 node_modules 添加到环境变量之中即可直接使用 hexo <command>：</p>
<p>echo ‘PATH=”$PATH:./node_modules/.bin”‘ &gt;&gt; ~/.profile</p>
<h2 id="Github账户与本地Git绑定"><a href="#Github账户与本地Git绑定" class="headerlink" title="Github账户与本地Git绑定"></a>Github账户与本地Git绑定</h2><p><strong>鼠标右击打开Git Bash：</strong></p>
<p>设置user.name和user.email配置信息：</p>
<p>git config –global user.name “你的GitHub用户名”<br>git config –global user.email “你的GitHub注册邮箱”</p>
<p>生成ssh密钥文件：<br>ssh-keygen -t rsa -C “你的GitHub注册邮箱”</p>
<p>设置github ssh<br>打开github，在头像下面点击settings，再点击SSH and GPG keys，新建一个SSH，名字随便。</p>
<p>git bash中输入</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cat ~&#x2F;.ssh&#x2F;id_rsa.pub</span><br></pre></td></tr></table></figure>

<p>Title为标题，任意填即可，将刚刚复制的id_rsa.pub内容粘贴进去，最后点击Add SSH key<br>在Git Bash中检测GitHub公钥设置是否成功:<br>输入ssh -T <a href="mailto:git@github.com">git@github.com</a>，如果如下图所示，出现你的用户名，那就成功了。</p>
<p><img src="http://jiali.clouddn.com/20200714_002.png.jpg" alt="20200714_002.png"></p>
<p><strong>Github</strong> 创建个人博客创库</p>
<p><img src="http://jiali.clouddn.com/20200714_003.jpg" alt="20200714_003"></p>
<p>然后如下图所示，输入自己的项目名字，后面一定要加.github.io后缀，README初始化也要勾上。</p>
<p><img src="http://jiali.clouddn.com/20200714_004.jpg" alt="20200714_004"></p>
<p>然后项目就建成了，点击Settings，向下拉到最后有个GitHub Pages，点击Choose a theme选择一个主题。然后等一会儿，再回到GitHub Pages，会变成下面这样：</p>
<p><img src="http://jiali.clouddn.com/20200714_005.jpg" alt="20200714_005"></p>
<p>点击那个链接，就会出现自己的网页啦，效果如下：</p>
<p><img src="http://jiali.clouddn.com/20200714_006.jpg" alt="20200714_006"></p>
<h2 id="发布文章"><a href="#发布文章" class="headerlink" title="发布文章"></a>发布文章</h2><ol>
<li>创建博客根目录<br>在硬盘创建一个目录作为博客根目录blog</li>
<li>初始化博客根目录</li>
</ol>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ hexo init blog</span><br></pre></td></tr></table></figure>

<p>3.安装deployer-git</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure>

<p>在/blog/_config.yml中修改deploy属性(注意:之后有空格)</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">deploy:</span><br><span class="line">  type: git</span><br><span class="line">  repository: https:&#x2F;&#x2F;github.com&#x2F;thesingularityisnear&#x2F;thesingularityisnear.github.io.git</span><br><span class="line">  branch: master</span><br></pre></td></tr></table></figure>

<p>4.新建文章</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">hexo new post &quot;article title&quot;</span><br></pre></td></tr></table></figure>

<p>markdown 格式编辑文章</p>
<p>5．生成静态网页</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">hexo g &#x2F;&#x2F;产生静态博客网页</span><br><span class="line">hexo s&#x2F;&#x2F;本地预览</span><br><span class="line">hexo d &#x2F;&#x2F;上传到github</span><br></pre></td></tr></table></figure>

<p>遇到问题：</p>
<p>1.本地与github绑定失败：</p>
<p>解决办法：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ssh-keygen -t rsa -C &quot;你的GitHub注册邮箱&quot;</span><br></pre></td></tr></table></figure>

<p>然后直接三个回车即可，默认不需要设置密码</p>
<p>2.deploy 写错，导致不能发布到GIthub,正确格式如下：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># Deployment</span><br><span class="line">## Docs: https:&#x2F;&#x2F;hexo.io&#x2F;docs&#x2F;deployment.html</span><br><span class="line">deploy:</span><br><span class="line">  type: git</span><br><span class="line">  repository: https:&#x2F;&#x2F;github.com&#x2F;xxx&#x2F;xxx.github.io</span><br><span class="line">  branch: master</span><br></pre></td></tr></table></figure>

<p><strong>参考：</strong><br><a href="https://zhuanlan.zhihu.com/p/35668237" target="_blank" rel="noopener">超详细Hexo+Github博客搭建小白教程</a><br><a href="https://zhuanlan.zhihu.com/p/26625249" target="_blank" rel="noopener">GitHub+Hexo 搭建个人网站详细教程</a><br><a href="https://www.jianshu.com/p/84a8384be1ae" target="_blank" rel="noopener">Hexo使用指南</a><br><a href="https://hexo.io/zh-cn/docs/" target="_blank" rel="noopener">官方文档</a></p>
]]></content>
      <categories>
        <category>工具</category>
        <category>Hexo</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>Hexo:next主题menu设置</title>
    <url>/2020/05/08/%E5%B7%A5%E5%85%B7/hexo/next%E4%B8%BB%E9%A2%98menu%E8%AE%BE%E7%BD%AE/</url>
    <content><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>本教程针对next主题背景，给文章添加分类和标签。添加成功后，博客导航栏的分类和标签可以看到相应的文章。</p>
<h2 id="Hexo-next主题的菜单设置"><a href="#Hexo-next主题的菜单设置" class="headerlink" title="Hexo next主题的菜单设置"></a>Hexo next主题的菜单设置</h2><p>更改主题配置文件，将menu中相关字段取消屏蔽，更改后如下：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># ---------------------------------------------------------------</span><br><span class="line"># Menu Settings</span><br><span class="line"># ---------------------------------------------------------------</span><br><span class="line"></span><br><span class="line"># Usage: &#96;Key: &#x2F;link&#x2F; || icon&#96;</span><br><span class="line"># Key is the name of menu item. If the translation for this item is available, the translated text will be loaded, otherwise the Key name will be used. Key is case-senstive.</span><br><span class="line"># Value before &#96;||&#96; delimiter is the target link, value after &#96;||&#96; delimiter is the name of Font Awesome icon.</span><br><span class="line"># When running the site in a subdirectory (e.g. yoursite.com&#x2F;blog), remove the leading slash from link value (&#x2F;archives -&gt; archives).</span><br><span class="line"># External url should start with http:&#x2F;&#x2F; or https:&#x2F;&#x2F;</span><br><span class="line">menu:</span><br><span class="line">  home: &#x2F; || fa fa-home</span><br><span class="line">  about: &#x2F;about&#x2F; || fa fa-user</span><br><span class="line">  tags: &#x2F;tags&#x2F; || fa fa-tags</span><br><span class="line">  categories: &#x2F;categories&#x2F; || fa fa-th</span><br><span class="line">  archives: &#x2F;archives&#x2F; || fa fa-archive</span><br><span class="line">  #schedule: &#x2F;schedule&#x2F; || fa fa-calendar</span><br><span class="line">  #sitemap: &#x2F;sitemap.xml || fa fa-sitemap</span><br><span class="line">  #commonweal: &#x2F;404&#x2F; || fa fa-heartbeat</span><br></pre></td></tr></table></figure>

<p>然后执行调试命令</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ hexo g</span><br><span class="line">$ hexo s</span><br></pre></td></tr></table></figure>

<p>在浏览器输入</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;localhost:4000</span><br></pre></td></tr></table></figure>

<p>结果如下</p>
<p><img src="http://q9kx2gcuj.bkt.clouddn.com/20200508_001.png" alt="20200508_001"></p>
<h2 id="给文章分类"><a href="#给文章分类" class="headerlink" title="给文章分类"></a>给文章分类</h2><p>打开bash终端，进入博客根目录</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cd myhexo-next</span><br></pre></td></tr></table></figure>

<p>执行命令，创建分类page</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">hexo new page categories</span><br></pre></td></tr></table></figure>

<p>成功会提示:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">INFO  Created: E:\myhexo-next\source\categories\index.md</span><br></pre></td></tr></table></figure>

<p>根据提示的路径，找到index.md文件，打开默认内容如下：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line">title: categories</span><br><span class="line">date: 2020-05-08 09:27:33</span><br><span class="line">---</span><br></pre></td></tr></table></figure>

<p>title字段：分类页的标题</p>
<p>修改index.md文件，添加type字段及其属性，修改后如下</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line">title: 文章分类</span><br><span class="line">date: 2020-05-08 09:27:33</span><br><span class="line">type: &quot;categories&quot;</span><br><span class="line">---</span><br></pre></td></tr></table></figure>

<p>保存文件，执行调试命令。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ hexo g</span><br><span class="line">$ hexo s</span><br></pre></td></tr></table></figure>

<p>在浏览器输入:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;localhost:4000</span><br></pre></td></tr></table></figure>

<p>查看效果：<br><img src="http://q9kx2gcuj.bkt.clouddn.com/20200508_003.png" alt="20200508_003"></p>
<h2 id="给文章分类-1"><a href="#给文章分类-1" class="headerlink" title="给文章分类"></a>给文章分类</h2><p>打开.md文章，比如</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">hello-world.md</span><br></pre></td></tr></table></figure>

<p>在文章开头添加”YAML Front Matter”格式，然后添加分类字段属性。内容如下：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line">title: Hello World</span><br><span class="line">date: 2020-05-08 09:27:33</span><br><span class="line">categories: test</span><br><span class="line">---</span><br></pre></td></tr></table></figure>

<p><strong>备注</strong>：</p>
<p>title:文章标题</p>
<p>date:发表日期</p>
<p>同样，执行调试看效果</p>
<p><img src="http://q9kx2gcuj.bkt.clouddn.com/20200508_004.png" alt="20200508_004"></p>
<h2 id="给文章添加标签"><a href="#给文章添加标签" class="headerlink" title="给文章添加标签"></a>给文章添加标签</h2><p>步骤跟创建分类一样，区别在创建page命令。创建标签page命令如下：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ hexo new page tags</span><br></pre></td></tr></table></figure>

<p>后面所有的步骤跟分类一样。过程略，文章添加标签效果如下：</p>
<p><img src="http://q9kx2gcuj.bkt.clouddn.com/20200508_005.png" alt="20200508_005"></p>
<h2 id="创建About页面"><a href="#创建About页面" class="headerlink" title="创建About页面"></a>创建About页面</h2><p>新建一个About页面</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ hexo new page about</span><br></pre></td></tr></table></figure>

<p>成功则出现下面提示：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">INFO  Created: E:\myhexo-next\source\about\index.md</span><br></pre></td></tr></table></figure>

<p>进入about目录，打开index.md，默认内容如下：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line">title: about</span><br><span class="line">date: 2020-05-08 19:29:10</span><br><span class="line">---</span><br></pre></td></tr></table></figure>

<p>在默认内容下面，编辑about页面内容，比如：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">我是张三，软件高级工程师，我爱编程</span><br></pre></td></tr></table></figure>

<p>执行调试命令，效果如下：</p>
<p><img src="http://q9kx2gcuj.bkt.clouddn.com/20200508_006.png" alt="20200508_006"></p>
<h2 id="添加本地搜索"><a href="#添加本地搜索" class="headerlink" title="添加本地搜索"></a>添加本地搜索</h2><p>打开bash,进入博客的根目录，执行命令安装第三方搜索插件</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ npm install hexo-generator-searchdb --save</span><br></pre></td></tr></table></figure>

<p>在站点配置文件，增加搜索功能字段</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">search:</span><br><span class="line">  path: search.xml</span><br><span class="line">  field: post</span><br><span class="line">  format: html</span><br><span class="line">  limit: 10000</span><br></pre></td></tr></table></figure>

<ul>
<li>path：索引文件的路径，相对于站点根目录</li>
<li>field：搜索范围，默认是 post，还可以选择 page、all，设置成 all 表示搜索所有页面</li>
<li>limit：限制搜索的条目数</li>
</ul>
<p>然后修改主题配置文件，搜索关键字 local_search ,设置为 true，配置如下：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># Local Search</span><br><span class="line"># Dependencies: https:&#x2F;&#x2F;github.com&#x2F;theme-next&#x2F;hexo-generator-searchdb</span><br><span class="line">local_search:</span><br><span class="line">  enable: true</span><br><span class="line">  # If auto, trigger search by changing input.</span><br><span class="line">  # If manual, trigger search by pressing enter key or search button.</span><br><span class="line">  trigger: auto</span><br><span class="line">  # Show top n results per article, show all results by setting to -1</span><br><span class="line">  top_n_per_article: 1</span><br><span class="line">  # Unescape html strings to the readable one.</span><br><span class="line">  unescape: false</span><br><span class="line">  # Preload the search data when the page loads.</span><br><span class="line">  preload: false</span><br></pre></td></tr></table></figure>

<p>展示：</p>
<p><img src="http://q9kx2gcuj.bkt.clouddn.com/20200509_001.png" alt="20200509_001"></p>
<p>扩展：</p>
<p>多级分类配置：</p>
<p>打开source/categories/index.md,改为如下</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">title: 文章分类</span><br><span class="line">date: 2020-07-10 13:27:56</span><br><span class="line">type: &quot;categories&quot;</span><br><span class="line">comments: false</span><br></pre></td></tr></table></figure>

<p>然后，修改博文分类属性如下：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">title: Hexo环境搭建 </span><br><span class="line">date: 2019-12-10 21:02:06</span><br><span class="line">tags: Hexo</span><br><span class="line">categories:</span><br><span class="line">- 工具</span><br><span class="line">- hexo</span><br></pre></td></tr></table></figure>

<p>多级标签也是这样设置，最后效果如下。</p>
<p><img src="http://jiali.clouddn.com/20200716_001.png" alt="20200716_001"></p>
<p><strong>参考</strong>：</p>
<p><a href="https://rilzob.com/" target="_blank" rel="noopener">Hexo使用攻略：添加分类及标签</a></p>
<p><a href="https://whx4j8.github.io/" target="_blank" rel="noopener">hexo next 为文章添加分类</a></p>
<p><a href="https://linlif.github.io/" target="_blank" rel="noopener">Hexo使用攻略-添加分类及标签</a></p>
]]></content>
      <categories>
        <category>工具</category>
        <category>Hexo</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>hexo:Next主题博客优化</title>
    <url>/2020/05/09/%E5%B7%A5%E5%85%B7/hexo/Next%E4%B8%BB%E9%A2%98%E5%8D%9A%E5%AE%A2%E4%BC%98%E5%8C%96/</url>
    <content><![CDATA[<h2 id="1-在右上角或者左上角实现fork-me-on-github"><a href="#1-在右上角或者左上角实现fork-me-on-github" class="headerlink" title="1 在右上角或者左上角实现fork me on github"></a>1 在右上角或者左上角实现fork me on github</h2><p>从文字样式 <a href="https://github.blog/2008-12-19-github-ribbons/" target="_blank" rel="noopener">GitHub Ribbons</a>或<a href="http://tholman.com/github-corners/" target="_blank" rel="noopener">图标样式</a>，选择一个样式模板，并复制文本框中的代码，例如：</p>
<p><img src="http://q9kx2gcuj.bkt.clouddn.com/20200509_002.png" alt="20200509_002"></p>
<p>其中，href=”<a href="https://your-url&quot;修改为自己的github用户地址。" target="_blank" rel="noopener">https://your-url&quot;修改为自己的github用户地址。</a></p>
<p>打开 themes/next/layout/_layout.swig 文件，把代码复制到<div class="headband"></div>下面</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;body itemscope itemtype&#x3D;&quot;http:&#x2F;&#x2F;schema.org&#x2F;WebPage&quot;&gt;</span><br><span class="line">  &lt;div class&#x3D;&quot;container&#123;%- if theme.motion.enable %&#125; use-motion&#123;%- endif %&#125;&quot;&gt;</span><br><span class="line">    &lt;div class&#x3D;&quot;headband&quot;&gt;&lt;&#x2F;div&gt;</span><br><span class="line">	&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;github.com&#x2F;jialimeng&quot; class&#x3D;&quot;github-corner&quot; aria-label&#x3D;&quot;View source on GitHub&quot;&gt;&lt;svg width&#x3D;&quot;80&quot; height&#x3D;&quot;80&quot; viewBox&#x3D;&quot;0 0 250 250&quot; style&#x3D;&quot;fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;&quot; aria-hidden&#x3D;&quot;true&quot;&gt;&lt;path d&#x3D;&quot;M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z&quot;&gt;&lt;&#x2F;path&gt;&lt;path d&#x3D;&quot;M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2&quot; fill&#x3D;&quot;currentColor&quot; style&#x3D;&quot;transform-origin: 130px 106px;&quot; class&#x3D;&quot;octo-arm&quot;&gt;&lt;&#x2F;path&gt;&lt;path d&#x3D;&quot;M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z&quot; fill&#x3D;&quot;currentColor&quot; class&#x3D;&quot;octo-body&quot;&gt;&lt;&#x2F;path&gt;&lt;&#x2F;svg&gt;&lt;&#x2F;a&gt;&lt;style&gt;.github-corner:hover .octo-arm&#123;animation:octocat-wave 560ms ease-in-out&#125;@keyframes octocat-wave&#123;0%,100%&#123;transform:rotate(0)&#125;20%,60%&#123;transform:rotate(-25deg)&#125;40%,80%&#123;transform:rotate(10deg)&#125;&#125;@media (max-width:500px)&#123;.github-corner:hover .octo-arm&#123;animation:none&#125;.github-corner .octo-arm&#123;animation:octocat-wave 560ms ease-in-out&#125;&#125;&lt;&#x2F;style&gt;</span><br><span class="line">    &lt;header class&#x3D;&quot;header&quot; itemscope itemtype&#x3D;&quot;http:&#x2F;&#x2F;schema.org&#x2F;WPHeader&quot;&gt;</span><br><span class="line">      &lt;div class&#x3D;&quot;header-inner&quot;&gt;&#123;% include &#39;_partials&#x2F;header&#x2F;index.swig&#39; %&#125;&lt;&#x2F;div&gt;</span><br><span class="line">    &lt;&#x2F;header&gt;</span><br></pre></td></tr></table></figure>

<p>保存调试，就会看到效果如下：</p>
<p><img src="http://q9kx2gcuj.bkt.clouddn.com/20200509_004.png" alt="20200509_004"></p>
<h2 id="侧边栏优化"><a href="#侧边栏优化" class="headerlink" title="侧边栏优化"></a>侧边栏优化</h2><ul>
<li>个人头像设置</li>
<li>社交栏图标设置</li>
<li>友情链接设置</li>
<li>RSS订阅设置</li>
</ul>
<h3 id="头像设置"><a href="#头像设置" class="headerlink" title="头像设置"></a>头像设置</h3><p>在主题配置文件搜索avatar字段，配置如下：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># Sidebar Avatar</span><br><span class="line">avatar:</span><br><span class="line">  # Replace the default image and set the url here.</span><br><span class="line">  url: &#x2F;images&#x2F;avatar.gif</span><br><span class="line">  # If true, the avatar will be dispalyed in circle.</span><br><span class="line">  rounded: false</span><br><span class="line">  # If true, the avatar will be rotated with the cursor.</span><br><span class="line">  rotated: false</span><br></pre></td></tr></table></figure>

<p>url是图像存放地址，可以是本地文件路径，也可以是网络地址。本配置使用默认的图片</p>
<h3 id="社交栏配置"><a href="#社交栏配置" class="headerlink" title="社交栏配置"></a>社交栏配置</h3><p>在主题配置文件中，搜索social，接下来，就看你需要显示什么社交网站，写上网站名+网址</p>
<p>比如原来配置中的网站：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># Social Links</span><br><span class="line"># Usage: &#96;Key: permalink || icon&#96;</span><br><span class="line"># Key is the link label showing to end users.</span><br><span class="line"># Value before &#96;||&#96; delimiter is the target permalink, value after &#96;||&#96; delimiter is the name of Font Awesome icon.</span><br><span class="line">social:</span><br><span class="line">  GitHub: https:&#x2F;&#x2F;github.com&#x2F;yourname || fab fa-github</span><br><span class="line">  #E-Mail: mailto:yourname@gmail.com || fa fa-envelope</span><br><span class="line">  #Weibo: https:&#x2F;&#x2F;weibo.com&#x2F;yourname || fab fa-weibo</span><br><span class="line">  #Google: https:&#x2F;&#x2F;plus.google.com&#x2F;yourname || fab fa-google</span><br><span class="line">  #Twitter: https:&#x2F;&#x2F;twitter.com&#x2F;yourname || fab fa-twitter</span><br><span class="line">  #FB Page: https:&#x2F;&#x2F;www.facebook.com&#x2F;yourname || fab fa-facebook</span><br><span class="line">  #StackOverflow: https:&#x2F;&#x2F;stackoverflow.com&#x2F;yourname || fab fa-stack-overflow</span><br><span class="line">  #YouTube: https:&#x2F;&#x2F;youtube.com&#x2F;yourname || fab fa-youtube</span><br><span class="line">  #Instagram: https:&#x2F;&#x2F;instagram.com&#x2F;yourname || fab fa-instagram</span><br><span class="line">  #Skype: skype:yourname?call|chat || fab fa-skype</span><br></pre></td></tr></table></figure>

<h3 id="友情链接配置"><a href="#友情链接配置" class="headerlink" title="友情链接配置"></a>友情链接配置</h3><p>打开 主题配置文件,搜索关键字 links：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># Blog rolls</span><br><span class="line">links_settings:</span><br><span class="line">  icon: fa fa-link</span><br><span class="line">  title: Links</span><br><span class="line">  # Available values: block | inline</span><br><span class="line">  layout: inline</span><br><span class="line"></span><br><span class="line">links:</span><br><span class="line">  Title: http:&#x2F;&#x2F;yoursite.com</span><br><span class="line">  百度: http:&#x2F;&#x2F;www.baidu.com</span><br></pre></td></tr></table></figure>

<p>在links字段下，写上名字及其地址。</p>
<p><strong>备注</strong>：</p>
<p>layout作用：链接站点的排版</p>
<p>block:竖排</p>
<p>inline:横排</p>
<h3 id="RSS订阅设置"><a href="#RSS订阅设置" class="headerlink" title="RSS订阅设置"></a>RSS订阅设置</h3><p>安装网上给的步骤，RSS没有出来，不知道为什么。配置步骤是这样</p>
<p>步骤1：执行安装插件命令</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ npm install hexo-generator-feed</span><br></pre></td></tr></table></figure>

<p>步骤2：修改站点配置文件，添加如下内容</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># Extensions</span><br><span class="line">## Plugins: http:&#x2F;&#x2F;hexo.io&#x2F;plugins&#x2F;</span><br><span class="line">#RSS订阅</span><br><span class="line">#plugin: </span><br><span class="line">#- hexo-generator-feed</span><br><span class="line"># feed</span><br><span class="line"># Dependencies: https:&#x2F;&#x2F;github.com&#x2F;hexojs&#x2F;hexo-generator-feed</span><br><span class="line">feed:</span><br><span class="line">  type: atom</span><br><span class="line">  path: atom.xml</span><br><span class="line">  limit: 20</span><br><span class="line">  hub:</span><br><span class="line">  content:</span><br><span class="line">  content_limit: 140</span><br><span class="line">  content_limit_delim: &#39; &#39;</span><br><span class="line">  order_by: -date</span><br><span class="line">  icon: icon.png</span><br><span class="line">  autodiscovery: true</span><br><span class="line">  template:</span><br></pre></td></tr></table></figure>

<p>步骤3：最后修改主题配置文件，修改内容如下：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">follow_me:</span><br><span class="line">  #Twitter: https:&#x2F;&#x2F;twitter.com&#x2F;username || fab fa-twitter</span><br><span class="line">  #Telegram: https:&#x2F;&#x2F;t.me&#x2F;channel_name || fab fa-telegram</span><br><span class="line">  #WeChat: &#x2F;images&#x2F;wechat_channel.jpg || fab fa-weixin</span><br><span class="line">  RSS: atom.xml || fa fa-rss</span><br></pre></td></tr></table></figure>



<p>最后给侧栏的效果如下：</p>
<p><img src="http://q9kx2gcuj.bkt.clouddn.com/20200509_005.png" alt="20200509_005"></p>
<p>参考：</p>
<p><a href="https://blog.junyu.io/posts/0005-next-theme-settings.html#menu" target="_blank" rel="noopener">Next主题配置文件说明</a></p>
<p><a href="https://juejin.im/post/5a71ab9f518825735300ee6c" target="_blank" rel="noopener">NexT主题的配置和优化指南</a></p>
<p><a href="http://shenzekun.cn/" target="_blank" rel="noopener">hexo的next主题个性化教程:打造炫酷网站</a></p>
<p><a href="https://zhuanlan.zhihu.com/p/30836436" target="_blank" rel="noopener">Hexo+Next主题优化</a></p>
<p><a href="http://eternalzttz.com/hexo-next.html" target="_blank" rel="noopener">hexo next主题优化，打造个人精致网站</a></p>
]]></content>
      <categories>
        <category>工具</category>
        <category>Hexo</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>【转载】Markdown 语法手册 （完整整理版）</title>
    <url>/2020/04/30/%E5%B7%A5%E5%85%B7/markdown/%E3%80%90%E8%BD%AC%E8%BD%BD%E3%80%91Markdown%20%E8%AF%AD%E6%B3%95%E6%89%8B%E5%86%8C%20%EF%BC%88%E5%AE%8C%E6%95%B4%E6%95%B4%E7%90%86%E7%89%88%EF%BC%89/</url>
    <content><![CDATA[<ul>
<li>目录<br>{:toc}</li>
</ul>
<hr>
<h4 id="1-斜体和粗体"><a href="#1-斜体和粗体" class="headerlink" title="1. 斜体和粗体"></a>1. 斜体和粗体</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">*斜体*或_斜体_</span><br><span class="line">**粗体**</span><br><span class="line">***加粗斜体***</span><br><span class="line">~~删除线~~</span><br></pre></td></tr></table></figure>
<p>view</p>
<p><em>斜体</em>或<em>斜体</em></p>
<p><strong>粗体</strong></p>
<p><strong><em>加粗斜体</em></strong></p>
<p><del>删除线</del></p>
<hr>
<h4 id="2-分级标题"><a href="#2-分级标题" class="headerlink" title="2. 分级标题"></a>2. 分级标题</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 一级标题</span><br><span class="line">## 二级标题</span><br><span class="line">### 三级标题</span><br><span class="line">#### 四级标题</span><br><span class="line">##### 五级标题</span><br><span class="line">###### 六级标题</span><br></pre></td></tr></table></figure>
<p>由于用了[TOC]标记编辑器会把所有标题写到目录大纲中，在这里写的演示标题也会列进去，所以就不演示了。同学们自己在编辑器中观察，很简单，一级标题字号最大，依级递减。</p>
<hr>
<h4 id="3-超链接"><a href="#3-超链接" class="headerlink" title="3. 超链接"></a>3. 超链接</h4><p>Markdown 支持两种形式的链接语法： 行内式和参考式两种形式，行内式一般使用较多。</p>
<h5 id="3-1-行内式"><a href="#3-1-行内式" class="headerlink" title="3.1. 行内式"></a>3.1. 行内式</h5><p>语法说明：</p>
<p>[]里写链接文字，()里写链接地址, ()中的”“中可以为链接指定title属性，title属性可加可不加。title属性的效果是鼠标悬停在链接上会出现指定的 title文字。链接地址与链接标题前有一个空格。</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">欢迎来到[<span class="string">Demi的随笔和技术空间</span>](<span class="link">https://yuhongjun.github.io/</span>)</span><br><span class="line"></span><br><span class="line">欢迎来到[<span class="string">Demi的随笔和技术空间</span>](<span class="link">https://yuhongjun.github.io/ "Demi的随笔和技术空间"</span>)</span><br></pre></td></tr></table></figure>
<p>view</p>
<p>欢迎来到<a href="https://yuhongjun.github.io/" target="_blank" rel="noopener">Demi的随笔和技术空间</a></p>
<p>欢迎来到<a href="https://yuhongjun.github.io/" target="_blank" rel="noopener" title="Demi的随笔和技术空间">Demi的随笔和技术空间</a></p>
<h5 id="3-2-参考式"><a href="#3-2-参考式" class="headerlink" title="3.2. 参考式"></a>3.2. 参考式</h5><p>参考式超链接一般用在学术论文上面，或者另一种情况，如果某一个链接在文章中多处使用，那么使用引用 的方式创建链接将非常好，它可以让你对链接进行统一的管理。</p>
<p>语法说明：<br>参考式链接分为两部分，文中的写法 [链接文字][链接标记]，在文本的任意位置添加[链接标记]:链接地址 “链接标题”，链接地址与链接标题前有一个空格。</p>
<p>如果链接文字本身可以做为链接标记，你也可以写成[链接文字][]<br>[链接文字]：链接地址的形式，见代码的最后一行。</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">我经常去的几个网站[<span class="string">Google</span>][<span class="symbol">1</span>],[<span class="string">Demi的随笔和技术空间</span>][<span class="symbol">2</span>],[<span class="string">Demi的随笔和技术空间</span>][<span class="symbol"></span>]。</span><br><span class="line"></span><br><span class="line">[<span class="symbol">1</span>]:<span class="link">http://www.google.com</span></span><br><span class="line">[<span class="symbol">2</span>]:<span class="link">https://yuhongjun.github.io/ "Demi的随笔和技术空间"</span></span><br><span class="line">[<span class="symbol">Demi的随笔和技术空间</span>]:<span class="link">https://yuhongjun.github.io/</span></span><br></pre></td></tr></table></figure>

<p>我经常去的几个网站<a href="http://www.google.com" target="_blank" rel="noopener">Google</a>,<a href="https://yuhongjun.github.io/" target="_blank" rel="noopener" title="Demi的随笔和技术空间">Demi的随笔和技术空间</a>,<a href="https://yuhongjun.github.io/" target="_blank" rel="noopener">Demi的随笔和技术空间</a>。</p>
<h5 id="3-3-自动链接"><a href="#3-3-自动链接" class="headerlink" title="3.3. 自动链接"></a>3.3. 自动链接</h5><p>语法说明：<br>Markdown 支持以比较简短的自动链接形式来处理网址和电子邮件信箱，只要是用&lt;&gt;包起来， Markdown 就会自动把它转成链接。一般网址的链接文字就和链接地址一样，例如：</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">http:</span>//<span class="attr">example.com</span>/&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">address@example.com</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<p>view</p>
<p><a href="http://example.com/" target="_blank" rel="noopener">http://example.com/</a><br><a href="mailto:&#97;&#100;&#100;&#x72;&#x65;&#x73;&#115;&#64;&#101;&#x78;&#x61;&#x6d;&#x70;&#108;&#101;&#46;&#99;&#111;&#109;">&#97;&#100;&#100;&#x72;&#x65;&#x73;&#115;&#64;&#101;&#x78;&#x61;&#x6d;&#x70;&#108;&#101;&#46;&#99;&#111;&#109;</a></p>
<hr>
<h4 id="4-锚点"><a href="#4-锚点" class="headerlink" title="4. 锚点"></a>4. 锚点</h4><p>网页中，锚点其实就是页内超链接，也就是链接本文档内部的某些元素，实现当前页面中的跳转。比如我这里写下一个锚点，点击回到目录，就能跳转到目录。 在目录中点击这一节，就能跳过来。还有下一节的注脚。这些根本上都是用锚点来实现的。</p>
<p>注意： </p>
<ol>
<li>Markdown Extra 只支持在标题后插入锚点，其它地方无效。 </li>
<li>Leanote 编辑器右侧显示效果区域暂时不支持锚点跳转，所以点来点去发现没有跳转不必惊慌，但是你发布成笔记或博文后是支持跳转的。</li>
</ol>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line"><span class="section">## 0. 跳转测试&#123;#index&#125;</span></span><br><span class="line"></span><br><span class="line">跳转到[<span class="string">跳转测试</span>](<span class="link">#index</span>)</span><br></pre></td></tr></table></figure>

<hr>
<h4 id="5-列表"><a href="#5-列表" class="headerlink" title="5. 列表"></a>5. 列表</h4><h5 id="5-1-无序列表"><a href="#5-1-无序列表" class="headerlink" title="5.1. 无序列表"></a>5.1. 无序列表</h5><p>使用 *，+，- 表示无序列表。</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line"><span class="bullet">- </span>无序列表项 一</span><br><span class="line"><span class="bullet">- </span>无序列表项 二</span><br><span class="line"><span class="bullet">- </span>无序列表项 三</span><br></pre></td></tr></table></figure>
<p>view</p>
<ul>
<li>无序列表项 一</li>
<li>无序列表项 二</li>
<li>无序列表项 三</li>
</ul>
<h5 id="5-2-有序列表"><a href="#5-2-有序列表" class="headerlink" title="5.2. 有序列表"></a>5.2. 有序列表</h5><p>有序列表则使用数字接着一个英文句点。</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line"><span class="bullet">1. </span>有序列表项 一</span><br><span class="line"><span class="bullet">2. </span>有序列表项 二</span><br><span class="line"><span class="bullet">3. </span>有序列表项 三</span><br></pre></td></tr></table></figure>
<p>view</p>
<ol>
<li>有序列表项 一</li>
<li>有序列表项 二</li>
<li>有序列表项 三</li>
</ol>
<h5 id="5-3-定义型列表"><a href="#5-3-定义型列表" class="headerlink" title="5.3. 定义型列表"></a>5.3. 定义型列表</h5><p>语法说明：</p>
<p>定义型列表由名词和解释组成。一行写上定义，紧跟一行写上解释。解释的写法:紧跟一个缩进(Tab)</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">代码块 1 Markdown</span><br><span class="line">:    轻量级文本标记语言，可以转换成html，pdf等格式（左侧有一个可见的冒号和四个不可见的空格）</span><br><span class="line"></span><br><span class="line">代码块 2</span><br><span class="line">:   这是代码块的定义（左侧有一个可见的冒号和四个不可见的空格）</span><br><span class="line"></span><br><span class="line"><span class="code">        代码块（左侧有八个不可见的空格）</span></span><br></pre></td></tr></table></figure>
<p>view</p>
<dl><dt>代码块 1 Markdown</dt><dd>轻量级文本标记语言，可以转换成html，pdf等格式（左侧有一个可见的冒号和四个不可见的空格）</dd></dl><dl><dt>代码块 2</dt><dd>这是代码块的定义（左侧有一个可见的冒号和四个不可见的空格）</dd></dl><pre><code>代码块（左侧有八个不可见的空格）</code></pre><h5 id="5-3-列表缩进"><a href="#5-3-列表缩进" class="headerlink" title="5.3. 列表缩进"></a>5.3. 列表缩进</h5><p>语法说明：</p>
<p>列表项目标记通常是放在最左边，但是其实也可以缩进，最多 3 个空格，项目标记后面则一定要接着至少一个空格或制表符。</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line"><span class="bullet">*   </span>轻轻的我走了， 正如我轻轻的来； 我轻轻的招手， 作别西天的云彩。</span><br><span class="line">那河畔的金柳， 是夕阳中的新娘； 波光里的艳影， 在我的心头荡漾。 </span><br><span class="line">软泥上的青荇， 油油的在水底招摇； 在康河的柔波里， 我甘心做一条水草！ </span><br><span class="line"><span class="bullet">*   </span>那榆荫下的一潭， 不是清泉， 是天上虹； 揉碎在浮藻间， 沉淀着彩虹似的梦。 </span><br><span class="line">寻梦？撑一支长篙， 向青草更青处漫溯； 满载一船星辉， 在星辉斑斓里放歌。 </span><br><span class="line">但我不能放歌， 悄悄是别离的笙箫； 夏虫也为我沉默， 沉默是今晚的康桥！ </span><br><span class="line">悄悄的我走了， 正如我悄悄的来； 我挥一挥衣袖， 不带走一片云彩。</span><br></pre></td></tr></table></figure>
<p>view</p>
<ul>
<li>轻轻的我走了， 正如我轻轻的来； 我轻轻的招手， 作别西天的云彩。<br>那河畔的金柳， 是夕阳中的新娘； 波光里的艳影， 在我的心头荡漾。<br>软泥上的青荇， 油油的在水底招摇； 在康河的柔波里， 我甘心做一条水草！ </li>
<li>那榆荫下的一潭， 不是清泉， 是天上虹； 揉碎在浮藻间， 沉淀着彩虹似的梦。<br>寻梦？撑一支长篙， 向青草更青处漫溯； 满载一船星辉， 在星辉斑斓里放歌。<br>但我不能放歌， 悄悄是别离的笙箫； 夏虫也为我沉默， 沉默是今晚的康桥！<br>悄悄的我走了， 正如我悄悄的来； 我挥一挥衣袖， 不带走一片云彩。</li>
</ul>
<h5 id="5-4-包含段落的列表"><a href="#5-4-包含段落的列表" class="headerlink" title="5.4. 包含段落的列表"></a>5.4. 包含段落的列表</h5><p>语法说明：</p>
<p>列表项目可以包含多个段落，每个项目下的段落都必须缩进 4 个空格或是 1 个制表符（显示效果与代码一致）：</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line"><span class="bullet">*   </span>轻轻的我走了， 正如我轻轻的来； 我轻轻的招手， 作别西天的云彩。</span><br><span class="line">那河畔的金柳， 是夕阳中的新娘； 波光里的艳影， 在我的心头荡漾。 </span><br><span class="line">软泥上的青荇， 油油的在水底招摇； 在康河的柔波里， 我甘心做一条水草！</span><br><span class="line"></span><br><span class="line"><span class="code">     那榆荫下的一潭， 不是清泉， 是天上虹； 揉碎在浮藻间， 沉淀着彩虹似的梦。 </span></span><br><span class="line">寻梦？撑一支长篙， 向青草更青处漫溯； 满载一船星辉， 在星辉斑斓里放歌。 </span><br><span class="line">但我不能放歌， 悄悄是别离的笙箫； 夏虫也为我沉默， 沉默是今晚的康桥！</span><br><span class="line"></span><br><span class="line"><span class="bullet">*    </span>悄悄的我走了， 正如我悄悄的来； 我挥一挥衣袖， 不带走一片云彩。</span><br></pre></td></tr></table></figure>
<p>view</p>
<ul>
<li><p>轻轻的我走了， 正如我轻轻的来； 我轻轻的招手， 作别西天的云彩。<br>那河畔的金柳， 是夕阳中的新娘； 波光里的艳影， 在我的心头荡漾。<br>软泥上的青荇， 油油的在水底招摇； 在康河的柔波里， 我甘心做一条水草！</p>
<p> 那榆荫下的一潭， 不是清泉， 是天上虹； 揉碎在浮藻间， 沉淀着彩虹似的梦。<br>寻梦？撑一支长篙， 向青草更青处漫溯； 满载一船星辉， 在星辉斑斓里放歌。<br>但我不能放歌， 悄悄是别离的笙箫； 夏虫也为我沉默， 沉默是今晚的康桥！ </p>
</li>
<li><p>悄悄的我走了， 正如我悄悄的来； 我挥一挥衣袖， 不带走一片云彩。</p>
</li>
</ul>
<h5 id="5-5-包含引用的列表"><a href="#5-5-包含引用的列表" class="headerlink" title="5.5. 包含引用的列表"></a>5.5. 包含引用的列表</h5><p>语法说明：</p>
<p>如果要在列表项目内放进引用，那 &gt; 就需要缩进：</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line"><span class="bullet">*   </span>阅读的方法:</span><br><span class="line"><span class="code">    &gt; 打开书本。</span></span><br><span class="line"><span class="code">    &gt; 打开电灯。</span></span><br></pre></td></tr></table></figure>
<p>view</p>
<ul>
<li>阅读的方法:<blockquote>
<p>打开书本。<br>打开电灯。</p>
</blockquote>
</li>
</ul>
<h5 id="5-6-包含代码区块的引用"><a href="#5-6-包含代码区块的引用" class="headerlink" title="5.6. 包含代码区块的引用"></a>5.6. 包含代码区块的引用</h5><p>语法说明：<br>如果要放代码区块的话，该区块就需要缩进两次，也就是 8 个空格或是 2 个制表符：</p>
<h5 id="5-7-一个特殊情况"><a href="#5-7-一个特殊情况" class="headerlink" title="5.7. 一个特殊情况"></a>5.7. 一个特殊情况</h5><p>在特殊情况下，项目列表很可能会不小心产生，像是下面这样的写法：</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line"><span class="bullet">1986. </span>What a great season.</span><br></pre></td></tr></table></figure>
<p>会显示成：</p>
<ol start="1986">
<li>What a great season.</li>
</ol>
<p>换句话说，也就是在行首出现数字-句点-空白，要避免这样的状况，你可以在句点前面加上反斜杠：</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">1986\. What a great season.</span><br></pre></td></tr></table></figure>
<p>才会正常显示成：</p>
<p>1986. What a great season.</p>
<hr>
<h4 id="6-引用"><a href="#6-引用" class="headerlink" title="6. 引用"></a>6. 引用</h4><p>语法说明：</p>
<p>引用需要在被引用的文本前加上&gt;符号。</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line"><span class="quote">&gt; 这是一个有两段文字的引用,</span></span><br><span class="line">无意义的占行文字1.</span><br><span class="line">无意义的占行文字2.</span><br><span class="line"></span><br><span class="line"><span class="quote">&gt; 无意义的占行文字3.</span></span><br><span class="line">无意义的占行文字4.</span><br></pre></td></tr></table></figure>
<p>view</p>
<blockquote>
<p>这是一个有两段文字的引用,<br>无意义的占行文字1.<br>无意义的占行文字2.</p>
</blockquote>
<blockquote>
<p>无意义的占行文字3.<br>无意义的占行文字4.</p>
</blockquote>
<h5 id="6-1-引用的多层嵌套"><a href="#6-1-引用的多层嵌套" class="headerlink" title="6.1. 引用的多层嵌套"></a>6.1. 引用的多层嵌套</h5><p>区块引用可以嵌套（例如：引用内的引用），只要根据层次加上不同数量的 &gt; ：</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; 请问 Markdwon 怎么用？ - 小白</span><br><span class="line"></span><br><span class="line">&gt;&gt; 自己看教程！ - 愤青</span><br><span class="line"></span><br><span class="line"><span class="quote">&gt; 教程在哪？ - 小白</span></span><br></pre></td></tr></table></figure>
<blockquote>
<blockquote>
<blockquote>
<p>请问 Markdwon 怎么用？ - 小白</p>
</blockquote>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p>自己看教程！ - 愤青</p>
</blockquote>
</blockquote>
<blockquote>
<p>教程在哪？ - 小白</p>
</blockquote>
<h5 id="6-2-引用其它要素"><a href="#6-2-引用其它要素" class="headerlink" title="6.2. 引用其它要素"></a>6.2. 引用其它要素</h5><p>引用的区块内也可以使用其他的 Markdown 语法，包括标题、列表、代码区块等：</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line"><span class="quote">&gt; 1.   这是第一行列表项。</span></span><br><span class="line"><span class="quote">&gt; 2.   这是第二行列表项。</span></span><br><span class="line"><span class="quote">&gt; </span></span><br><span class="line"><span class="quote">&gt; 给出一些例子代码：</span></span><br><span class="line"><span class="quote">&gt; </span></span><br><span class="line"><span class="quote">&gt;     return shell_exec("echo $input | $markdown_script");</span></span><br></pre></td></tr></table></figure>
<blockquote>
<ol>
<li>这是第一行列表项。</li>
<li>这是第二行列表项。</li>
</ol>
<p>给出一些例子代码：</p>
<pre><code>return shell_exec(&quot;echo $input | $markdown_script&quot;);</code></pre></blockquote>
<hr>
<h4 id="7-插入图像"><a href="#7-插入图像" class="headerlink" title="7. 插入图像"></a>7. 插入图像</h4><p>图片的创建方式与超链接相似，而且和超链接一样也有两种写法，行内式和参考式写法。</p>
<p>语法中图片Alt的意思是如果图片因为某些原因不能显示，就用定义的图片Alt文字来代替图片。 图片Title则和链接中的Title一样，表示鼠标悬停与图片上时出现的文字。 Alt 和 Title 都不是必须的，可以省略，但建议写上。</p>
<h5 id="7-1-行内式"><a href="#7-1-行内式" class="headerlink" title="7.1. 行内式"></a>7.1. 行内式</h5><p>语法说明：![图片Alt](图片地址 “图片Title”)</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">美丽风景： </span><br><span class="line">![<span class="string">美丽风景</span>](<span class="link">https://yuhongjun.github.io/assets/media/scenery.jpeg "美丽风景"</span>)</span><br></pre></td></tr></table></figure>
<p>view<br>美丽风景：<br><img src="https://yuhongjun.github.io/assets/media/scenery.jpeg" alt="美丽风景" title="美丽风景"></p>
<p>7.2. 参考式</p>
<p>语法说明：</p>
<p>在文档要插入图片的地方写![图片Alt][标记]</p>
<p>在文档的最后写上[标记]:图片地址 “Title”</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">![<span class="string">美丽风景</span>](<span class="link">https://yuhongjun.github.io/assets/media/scenery.jpeg "美丽风景"</span>)</span><br><span class="line"></span><br><span class="line">[<span class="symbol">scenery</span>]:<span class="link">https://yuhongjun.github.io/assets/media/scenery.jpeg "美丽风景"</span></span><br></pre></td></tr></table></figure>
<p>view<br><img src="https://yuhongjun.github.io/assets/media/scenery.jpeg" alt="美丽风景" title="美丽风景"></p>
<hr>
<h4 id="8-内容目录"><a href="#8-内容目录" class="headerlink" title="8. 内容目录"></a>8. 内容目录</h4><p>在段落中填写 [TOC] 以显示全文内容的目录结构。</p>
<p>效果参见最上方的目录</p>
<hr>
<h4 id="9-注脚"><a href="#9-注脚" class="headerlink" title="9. 注脚"></a>9. 注脚</h4><p>语法说明：</p>
<p>在需要添加注脚的文字后加上脚注名字[^注脚名字],称为加注。 然后在文本的任意位置(一般在最后)添加脚注，脚注前必须有对应的脚注名字。</p>
<p>注意：经测试注脚与注脚之间必须空一行，不然会失效。成功后会发现，即使你没有把注脚写在文末，经Markdown转换后，也会自动归类到文章的最后。</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">使用 Markdown[^1]可以效率的书写文档, 直接转换成 HTML[^2], 你可以使用 Leanote[^Le] 编辑器进行书写。</span><br><span class="line"></span><br><span class="line">[<span class="symbol">^1</span>]:<span class="link">Markdown是一种纯文本标记语言</span></span><br><span class="line"></span><br><span class="line">[<span class="symbol">^2</span>]:<span class="link">HyperText Markup Language 超文本标记语言</span></span><br><span class="line"></span><br><span class="line">[<span class="symbol">^Le</span>]:<span class="link">开源笔记平台，支持Markdown和笔记直接发为博文</span></span><br></pre></td></tr></table></figure>
<p>view</p>
<p>使用 Markdown<a href="Markdown是一种纯文本标记语言">^1</a>可以效率的书写文档, 直接转换成 HTML[^2], 你可以使用 Leanote<a href="开源笔记平台，支持Markdown和笔记直接发为博文">^Le</a> 编辑器进行书写。</p>
<p>[^2]:HyperText Markup Language 超文本标记语言</p>
<p>注：脚注自动被搬运到最后面，请到文章末尾查看，并且脚注后方的链接可以直接跳转回到加注的地方。</p>
<hr>
<h4 id="10-LaTeX-公式"><a href="#10-LaTeX-公式" class="headerlink" title="10. LaTeX 公式"></a>10. LaTeX 公式</h4><h5 id="10-1-表示行内公式："><a href="#10-1-表示行内公式：" class="headerlink" title="10.1. $ 表示行内公式："></a>10.1. $ 表示行内公式：</h5><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">质能守恒方程可以用一个很简洁的方程式 $E=mc^2$ 来表达。</span><br></pre></td></tr></table></figure>
<p>view<br>质能守恒方程可以用一个很简洁的方程式 $E=mc^2$ 来表达。</p>
<h5 id="10-2-表示整行公式："><a href="#10-2-表示整行公式：" class="headerlink" title="10.2 $$ 表示整行公式："></a>10.2 $$ 表示整行公式：</h5><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$$\sum<span class="emphasis">_&#123;i=1&#125;^n a_</span>i=0$$</span><br><span class="line">$$f(x<span class="emphasis">_1,x_</span>x,\ldots,x<span class="emphasis">_n) = x_</span>1^2 + x<span class="emphasis">_2^2 + \cdots + x_</span>n^2 $$</span><br><span class="line">$$\sum^&#123;j-1&#125;<span class="emphasis">_&#123;k=0&#125;&#123;\widehat&#123;\gamma&#125;_</span>&#123;kj&#125; z_k&#125;$$</span><br></pre></td></tr></table></figure>
<p>访问 <a href="https://math.meta.stackexchange.com/questions/5020/mathjax-basic-tutorial-and-quick-reference" target="_blank" rel="noopener" title="MathJax basic tutorial and quick reference">MathJax</a> 参考更多使用方法。</p>
<hr>
<h4 id="11-流程图"><a href="#11-流程图" class="headerlink" title="11. 流程图"></a>11. 流程图</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;div&gt;</span><br><span class="line">&lt;textarea id&#x3D;&quot;code&quot; style&#x3D;&quot;width: 100%;&quot; rows&#x3D;&quot;11&quot;&gt;</span><br><span class="line">st&#x3D;&gt;start: Start|past:&gt;http:&#x2F;&#x2F;www.google.com[blank]</span><br><span class="line">e&#x3D;&gt;end: End:&gt;http:&#x2F;&#x2F;www.google.com</span><br><span class="line">op1&#x3D;&gt;operation: My Operation|past</span><br><span class="line">op2&#x3D;&gt;operation: Stuff|current</span><br><span class="line">sub1&#x3D;&gt;subroutine: My Subroutine|invalid</span><br><span class="line">cond&#x3D;&gt;condition: Yes</span><br><span class="line">or No?|approved:&gt;http:&#x2F;&#x2F;www.google.com</span><br><span class="line">c2&#x3D;&gt;condition: Good idea|rejected</span><br><span class="line">io&#x3D;&gt;inputoutput: catch something...|request</span><br><span class="line"></span><br><span class="line">st-&gt;op1(right)-&gt;cond</span><br><span class="line">cond(yes, right)-&gt;c2</span><br><span class="line">cond(no)-&gt;sub1(left)-&gt;op1</span><br><span class="line">c2(yes)-&gt;io-&gt;e</span><br><span class="line">c2(no)-&gt;op2-&gt;e</span><br><span class="line">&lt;&#x2F;textarea&gt;</span><br><span class="line">&lt;&#x2F;div&gt;</span><br><span class="line">&lt;div&gt;</span><br><span class="line">&lt;button id&#x3D;&quot;run&quot; type&#x3D;&quot;button&quot;&gt;Run&lt;&#x2F;button&gt;</span><br><span class="line">&lt;&#x2F;div&gt;</span><br><span class="line">&lt;div id&#x3D;&quot;canvas&quot;&gt;&lt;&#x2F;div&gt;</span><br></pre></td></tr></table></figure>
<p>you can  try different in textarea,then run .</p>
<div>
<textarea id="code" style="width: 100%;" rows="11">
st=>start: Start|past:>https://yuhongjun.github.io[blank]
e=>end: End:>https://yuhongjun.github.io
op1=>operation: My Operation|past
op2=>operation: Stuff|current
sub1=>subroutine: My Subroutine|invalid
cond=>condition: Yes
or No?|approved:>https://yuhongjun.github.io
c2=>condition: Good idea|rejected
io=>inputoutput: catch something...|request

<p>st-&gt;op1(right)-&gt;cond<br>cond(yes, right)-&gt;c2<br>cond(no)-&gt;sub1(left)-&gt;op1<br>c2(yes)-&gt;io-&gt;e<br>c2(no)-&gt;op2-&gt;e<br></textarea></p>
</div>
<div>
<button id="run" type="button">Run</button>
</div>
<div id="canvas"></div>

<p>更多语法参考：<a href="https://flowchart.js.org/" target="_blank" rel="noopener" title="flowchart">流程图语法参考</a></p>
<hr>
<h4 id="12-表格"><a href="#12-表格" class="headerlink" title="12 .表格"></a>12 .表格</h4><p>语法说明：</p>
<p>不管是哪种方式，第一行为表头，第二行分隔表头和主体部分，第三行开始每一行为一个表格行。<br>列于列之间用管道符|隔开。原生方式的表格每一行的两边也要有管道符。<br>第二行还可以为不同的列指定对齐方向。默认为左对齐，在-右边加上:就右对齐。</p>
<ol>
<li><p>简单方式写表格：</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">学号|姓名|分数</span><br><span class="line">-|-|-</span><br><span class="line">小明|男|75</span><br><span class="line">小红|女|79</span><br><span class="line">小陆|男|92</span><br></pre></td></tr></table></figure></li>
<li><p>原生方式写表格：</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">|学号|姓名|分数|</span><br><span class="line">|-|-|-|</span><br><span class="line">|小明|男|75|</span><br><span class="line">|小红|女|79|</span><br><span class="line">|小陆|男|92|</span><br></pre></td></tr></table></figure></li>
<li><p>为表格第二列指定方向：</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">产品|价格</span><br><span class="line">-|-:</span><br><span class="line">Leanote 高级账号|60元/年</span><br><span class="line">Leanote 超级账号|120元/年</span><br></pre></td></tr></table></figure>
<p>view</p>
</li>
<li><p>简单方式写表格：</p>
</li>
</ol>
<table>
<thead>
<tr>
<th>学号</th>
<th>姓名</th>
<th>分数</th>
</tr>
</thead>
<tbody><tr>
<td>小明</td>
<td>男</td>
<td>75</td>
</tr>
<tr>
<td>小红</td>
<td>女</td>
<td>79</td>
</tr>
<tr>
<td>小陆</td>
<td>男</td>
<td>92</td>
</tr>
</tbody></table>
<p>2.原生方式写表格：</p>
<table>
<thead>
<tr>
<th>学号</th>
<th>姓名</th>
<th>分数</th>
</tr>
</thead>
<tbody><tr>
<td>小明</td>
<td>男</td>
<td>75</td>
</tr>
<tr>
<td>小红</td>
<td>女</td>
<td>79</td>
</tr>
<tr>
<td>小陆</td>
<td>男</td>
<td>92</td>
</tr>
</tbody></table>
<p>3.为表格第二列指定方向：</p>
<table>
<thead>
<tr>
<th>产品</th>
<th align="right">价格</th>
</tr>
</thead>
<tbody><tr>
<td>Leanote 高级账号</td>
<td align="right">60元/年</td>
</tr>
<tr>
<td>Leanote 超级账号</td>
<td align="right">120元/年</td>
</tr>
</tbody></table>
<hr>
<h4 id="13-分隔线"><a href="#13-分隔线" class="headerlink" title="13. 分隔线"></a>13. 分隔线</h4><p>你可以在一行中用三个以上的星号、减号、底线来建立一个分隔线，行内不能有其他东西。你也可以在星号或是减号中间插入空格。下面每种写法都可以建立分隔线：</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line"><span class="bullet">* </span><span class="emphasis">* *</span></span><br><span class="line"></span><br><span class="line"><span class="emphasis">***</span></span><br><span class="line"></span><br><span class="line"><span class="strong">*****</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">- </span>- -</span><br><span class="line"></span><br><span class="line">---------------------------------------</span><br></pre></td></tr></table></figure>

<p>显示效果都一样</p>
<hr>
<h4 id="14-代码"><a href="#14-代码" class="headerlink" title="14. 代码"></a>14. 代码</h4><p>对于程序员来说这个功能是必不可少的，插入程序代码的方式有两种，一种是利用缩进(Tab), 另一种是利用”`”符号（一般在ESC键下方）包裹代码。</p>
<p>语法说明：</p>
<ol>
<li>插入行内代码，即插入一个单词或者一句代码的情况，使用<code>code</code>这样的形式插入。</li>
<li>插入多行代码，可以使用缩进或者“<code>code “</code>,具体看示例。</li>
</ol>
<p><strong>注意： 缩进式插入前方必须有空行</strong></p>
<h5 id="14-1-行内式"><a href="#14-1-行内式" class="headerlink" title="14.1. 行内式"></a>14.1. 行内式</h5><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">C语言里的函数 <span class="code">`scanf()`</span> 怎么使用？</span><br></pre></td></tr></table></figure>
<p>view<br>C语言里的函数 <code>scanf()</code> 怎么使用？</p>
<h5 id="14-2-缩进式多行代码"><a href="#14-2-缩进式多行代码" class="headerlink" title="14.2. 缩进式多行代码"></a>14.2. 缩进式多行代码</h5><p>缩进 4 个空格或是 1 个制表符</p>
<p>一个代码区块会一直持续到没有缩进的那一行（或是文件结尾）。</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line"><span class="section">#include &lt;stdio.h&gt;</span></span><br><span class="line">int main(void)</span><br><span class="line">&#123;</span><br><span class="line"><span class="code">    printf("Hello world\n");</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>view</p>
<pre><code>#include &lt;stdio.h&gt;
int main(void)
{
    printf(&quot;Hello world\n&quot;);
}</code></pre><h5 id="14-3-用六个-包裹多行代码"><a href="#14-3-用六个-包裹多行代码" class="headerlink" title="14.3. 用六个`包裹多行代码"></a>14.3. 用六个`包裹多行代码</h5><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line"><span class="code">` `</span> `</span><br><span class="line"><span class="section">#include &lt;stdio.h&gt;</span></span><br><span class="line">int main(void)</span><br><span class="line">&#123;</span><br><span class="line"><span class="code">    printf("Hello world\n");</span></span><br><span class="line">&#125;</span><br><span class="line">、、、</span><br></pre></td></tr></table></figure>

<h5 id="14-4-HTML-原始码"><a href="#14-4-HTML-原始码" class="headerlink" title="14.4. HTML 原始码"></a>14.4. HTML 原始码</h5><p>在代码区块里面， &amp; 、 &lt; 和 &gt; 会自动转成 HTML 实体，这样的方式让你非常容易使用 Markdown 插入范例用的 HTML 原始码，只需要复制贴上，剩下的 Markdown 都会帮你处理，例如：</p>
<p>第一个例子：</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"footer"</span>&gt;</span></span></span><br><span class="line">   © 2016 <span class="emphasis">***</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<p>view</p>
<div class="footer">
   © 2016 ***
</div>
转载：https://yuhongjun.github.io/tech/2017/05/02/Markdown-语法手册-完整整理版.html]]></content>
      <categories>
        <category>工具</category>
        <category>Markdown</category>
      </categories>
      <tags>
        <tag>Markdown</tag>
      </tags>
  </entry>
  <entry>
    <title>Typora+PicGo+七牛云实现图片上传</title>
    <url>/2020/04/30/%E5%B7%A5%E5%85%B7/markdown/Typora+PicGo+%E4%B8%83%E7%89%9B%E4%BA%91%E5%AE%9E%E7%8E%B0%E5%9B%BE%E7%89%87%E4%B8%8A%E4%BC%A0/</url>
    <content><![CDATA[<h2 id="1-前言"><a href="#1-前言" class="headerlink" title="1 前言"></a>1 前言</h2><p>Typora编写markdown，简洁高效。但是会遇到md文件拷贝到另一个电脑或者导入博客，图片失效的问题。解决的方法有很多。比较原始的是，拷贝md文件，连同图片一起拷贝放在一个目录。但是经常拷贝图片太麻烦，最好的办法就是把图片放在图床上。本人使用的是七牛云图床。本文总结Typora+PicGo+七牛云的实现过程。</p>
<h2 id="2-注册七牛云"><a href="#2-注册七牛云" class="headerlink" title="2 注册七牛云"></a>2 注册七牛云</h2><h3 id="2-1-进入官网注册"><a href="#2-1-进入官网注册" class="headerlink" title="2.1 进入官网注册"></a>2.1 进入官网注册</h3><p>点击<a href="https://www.qiniu.com/?utm_campaign=SEM&utm_content=pinzhuan&utm_medium=pinzhuan&utm_source=baiduSEM&utm_term=pinzhuan" target="_blank" rel="noopener">七牛云官网</a>，然后选择“注册有礼”，接着输入注册信息，然后下一步，点击个人申请。</p>
<p><img src="http://q9kx2gcuj.bkt.clouddn.com/202004301.png" alt="202004301"></p>
<h3 id="2-2-实名认证"><a href="#2-2-实名认证" class="headerlink" title="2.2 实名认证"></a>2.2 实名认证</h3><p>需要实名认证才能申请免费的10G空间</p>
<h3 id="2-3-建立存储空间"><a href="#2-3-建立存储空间" class="headerlink" title="2.3 建立存储空间"></a>2.3 建立存储空间</h3><p>回到<strong>主页</strong>，点击<strong>添加对象存储</strong>，然后，<strong>新建空间</strong>，填写<strong>空间配置信息</strong></p>
<p><img src="http://q9kx2gcuj.bkt.clouddn.com/202004302.png" alt="202004302"></p>
<h3 id="2-4-上传图片"><a href="#2-4-上传图片" class="headerlink" title="2.4 上传图片"></a>2.4 上传图片</h3><p><img src="http://q9kx2gcuj.bkt.clouddn.com/2020043003.png" alt="2020043003"></p>
<p>为了方便编写md过程中，插入图片时候自动上传图片到七牛云图床，这需要用到PicGO工具。</p>
<h2 id="3-PicGo工具安装与配置"><a href="#3-PicGo工具安装与配置" class="headerlink" title="3 PicGo工具安装与配置"></a>3 PicGo工具安装与配置</h2><h3 id="3-1-下载安装PicGo"><a href="#3-1-下载安装PicGo" class="headerlink" title="3.1 下载安装PicGo"></a>3.1 下载安装PicGo</h3><p><a href="https://github.com/Molunerfinn/PicGo/releases" target="_blank" rel="noopener">PicGo下载地址</a></p>
<h3 id="3-2打开PicGo并设置七牛云图床"><a href="#3-2打开PicGo并设置七牛云图床" class="headerlink" title="3.2打开PicGo并设置七牛云图床"></a>3.2打开PicGo并设置七牛云图床</h3><p><img src="http://q9kx2gcuj.bkt.clouddn.com/2020043004.png" alt="2020043004"></p>
<ul>
<li><p>AccessKey和Secretkey到七牛云个人中心的密钥管理获取</p>
</li>
<li><p>存储空间名设置为七牛云的存储空间的命令</p>
</li>
<li><p>访问地址在空间概况里获取（记得前面加http://）</p>
<p><img src="http://q9kx2gcuj.bkt.clouddn.com/2020043005.png" alt="2020043005"></p>
</li>
</ul>
<p><strong>七牛云的存储区域对应的简称</strong></p>
<p><img src="http://q9kx2gcuj.bkt.clouddn.com/2020043006.png" alt="2020043006"></p>
<h3 id="3-3测试PicGo上传图片"><a href="#3-3测试PicGo上传图片" class="headerlink" title="3.3测试PicGo上传图片"></a>3.3测试PicGo上传图片</h3><p>可以把图片拖拽到PicGo上传区，测试是否可以正常上传图片。链接格式为MarkDown</p>
<p><img src="http://q9kx2gcuj.bkt.clouddn.com/2020043007.png" alt="2020043007"></p>
<h2 id="4-Typora-配置-PicGo"><a href="#4-Typora-配置-PicGo" class="headerlink" title="4 Typora 配置 PicGo"></a>4 Typora 配置 PicGo</h2><h3 id="4-1配置图片上传"><a href="#4-1配置图片上传" class="headerlink" title="4.1配置图片上传"></a>4.1配置图片上传</h3><p>在Typora软件，打开<strong>文件</strong>选项，选择<strong>偏好设置</strong>，然后，选择<strong>图像</strong></p>
<p><img src="http://q9kx2gcuj.bkt.clouddn.com/2020043008.png" alt="2020043008"></p>
<p><strong>上传服务</strong>选择PicGo，<strong>PicGo路径</strong>为安装路径。<strong>点击验证图片上传选项</strong>，如果验证失败，请检查PicGo的监听接口是否为36677.</p>
<p><img src="http://q9kx2gcuj.bkt.clouddn.com/2020043009.png" alt="2020043009"></p>
<h3 id="4-2-上传图片"><a href="#4-2-上传图片" class="headerlink" title="4.2 上传图片"></a>4.2 上传图片</h3><p>上传方式有很多种。</p>
<p>方式一：在Typora,点击图片右键，选择上传图片</p>
<p>方式二：点击<strong>格式</strong>，选择<strong>图像</strong>，选中<strong>当插入图片时</strong>，勾选<strong>上传图片</strong></p>
<p><strong>参考</strong></p>
<p><a href="https://blog.csdn.net/weimeibuqieryu/article/details/105315807" target="_blank" rel="noopener">typora+picgo+七牛云实现图片上传</a></p>
<p><a href="https://zhuanlan.zhihu.com/p/114520225" target="_blank" rel="noopener">Typora 设置上传图片功能</a></p>
<p><a href="https://blog.csdn.net/sky0816/article/details/103638287" target="_blank" rel="noopener">Typora等markdown笔记软件图片链接失效的问题解决办法</a></p>
]]></content>
      <categories>
        <category>工具</category>
        <category>Markdown</category>
      </categories>
      <tags>
        <tag>Markdown</tag>
      </tags>
  </entry>
  <entry>
    <title>PCIe总线基础知识</title>
    <url>/2020/07/22/Linux/Driver/PCIe/PCIe%E6%80%BB%E7%BA%BF%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/</url>
    <content><![CDATA[<p>[TOC]</p>
<h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>PCIe,全称是PCI-Express（peripheral component interconnect express），这是一种高速串行计算机扩展总线标准。PCI总线使用并行总线结构，在同一条总线上的所有外部设备共享总线带宽，而PCIe总线使用高速串行差分总线，并采用端到端的连接方式，因此，在每一条PCIe链路中只能连接两个设备。两个设备之间的PCIe链路如下图所示。</p>
<p><img src="http://jiali.clouddn.com/20200722_001.png" alt=""></p>
<p>如果一条链路不够快，可以扩展多几个链路，犹如高速公路一样，车道越多，越少出现拥挤现象，开得越快。</p>
<p><img src="http://jiali.clouddn.com/20200722_002.png" alt=""></p>
<p>常见的PCIe插槽如下图所示。</p>
<p><img src="http://jiali.clouddn.com/20200724_007.png" alt=""></p>
<p>还有一些常见的PCIe设备如下图所示。</p>
<p><img src="http://jiali.clouddn.com/20200724_008.png" alt=""></p>
<h2 id="基础知识"><a href="#基础知识" class="headerlink" title="基础知识"></a>基础知识</h2><h3 id="硬件接口"><a href="#硬件接口" class="headerlink" title="硬件接口"></a>硬件接口</h3><p>PCIe链路使用端到端的数据传送，每一个端口都包含了发送端（TX）和接收端（RX），硬件接口如下图所示。</p>
<p><img src="http://jiali.clouddn.com/20200722_003.png" alt=""></p>
<p>从图可以看出，在PCIe总线物理链路的一条PCIe数据通路（Lane）中，发送端和接收端各自有一组差分信号D-和D+，共4根线。一条PCIe总线链路中可以由多个Lane组成。使用差分信号，抗干扰性更强，因此PCIe总线可以在很高频率下正常工作。</p>
<p>PCIe链路可以支持x1、x2、x4、x8、x12、x16和x32宽度的PCIe链路。频率和编码关系如下图所示。</p>
<p><img src="http://jiali.clouddn.com/20200722_004.png" alt=""></p>
<p>8/10b编码就是10bit中含有8bit有效数据，128/130b编码就是130bit含有128位有效数据。在PCIe总线中，使用GT(Gigatransfer)计算PCIe链路的峰值带宽。计算公式如下:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">总线频率*数据位宽*2</span><br></pre></td></tr></table></figure>

<h3 id="电气信号"><a href="#电气信号" class="headerlink" title="电气信号"></a>电气信号</h3><p>略。</p>
<h3 id="拓扑结构"><a href="#拓扑结构" class="headerlink" title="拓扑结构"></a>拓扑结构</h3><p>一个通用处理器的PCIe总线拓扑结构如下图所示。</p>
<p><img src="http://jiali.clouddn.com/20200723_002.png" alt=""></p>
<p>整个PCIe拓扑结构是一个树形结构，Root Complex（RC）是树的根。RC为CPU代言，与整个计算机系统其它部分通讯，比如CPU通过它访问内存，通过它访问PCIe系统中的设备。大多数PCIe总线结构中，都包含了RC 、Switch 、PCIe-to-PCI桥和Endpoint（PCIe设备）组件。</p>
<p>实际上，Root Complex,简称RC。RC设计比较复杂，一个虚拟的处理器系统的RC设计如下图所示。</p>
<p><img src="http://jiali.clouddn.com/20200723_003.png" alt=""></p>
<p><strong>RC组件</strong></p>
<p>在一个处理器系统PCIe总线中，都有一个RC控制器，主要完成地址转换，和物理信号转换。类似HOST主桥的角色。具体的RC设计，看具体的处理器系统。</p>
<p><strong>Switch</strong></p>
<p>因为一条PCIe链路使用端到端的连接方式，所以，只能连接一个设备。为了一条PCIe链路能挂载多个EP，因此，需要Switch器件进行扩展。一个标准的Switch具有一个上游端口和多个下游端口。Switch内部结构如下图所示。</p>
<p><img src="http://jiali.clouddn.com/20200723_004.png" alt=""></p>
<h2 id="PCIe总线分层结构"><a href="#PCIe总线分层结构" class="headerlink" title="PCIe总线分层结构"></a>PCIe总线分层结构</h2><p>PCIe总线采用串行硬件接口，并以数据包(Packet)格式进行数据传输。数据包需要通过事务层和数据链路层，最后达到物理层，发送出去。PCIe总线的分层如下图所示。</p>
<p><img src="http://jiali.clouddn.com/20200722_005.png" alt=""></p>
<p><strong>事务层</strong>的主要职责是创建（发送）或者解析（接收）TLP (Transaction Layer packet)，流量控制，QoS，事务排序等。</p>
<p><strong>数据链路层</strong>的主要职责是创建（发送）或者解析（接收）DLLP(Data Link Layer packet)，Ack/Nak协议（链路层检错和纠错），流控，电源管理等。</p>
<p><strong>物理层</strong>的主要职责是处理所有的Packet数据物理传输，发送端数据分发到各个Lane传输（stripe），接收端把各个Lane上的数据汇总起来（De-stripe），每个Lane上加扰（Scramble，目的是让0和1分布均匀，去除信道的电磁干扰EMI）去扰（De-scramble)，以及8/10或者128/130编码解码，等等。</p>
<p>每一层都会定义包头包尾的数据格式。如下图所示。</p>
<p><img src="http://jiali.clouddn.com/20200722_007.png" alt=""></p>
<p>CPU与设备端数据交互的过程如下图所示。</p>
<p><img src="http://jiali.clouddn.com/20200722_008.png" alt=""></p>
<h2 id="事务层的TLP协议"><a href="#事务层的TLP协议" class="headerlink" title="事务层的TLP协议"></a>事务层的TLP协议</h2><p>事务层将接收PCIe设备产生的数据请求，并封装成TLP协议。FPGA PCIe的开发工作，就是在PCIe核下封装TLP协议，其他层次基本看不到。因此，重点讲一下TLP协议。TLP的基本格式如下：</p>
<p><img src="http://jiali.clouddn.com/20200722_009.png" alt=""></p>
<p>TLP头是最重要的标志，TLP Head包含了当前TLP的总线事务类型、路由信息等一系列信息。Data Payload 表示有效数据，Data Payload 长度与Max_Payload_Size、Max_Read_Request_Size和RCB参数相关。</p>
<p><strong>TLP Head格式</strong></p>
<p>一个Header大小可以是3DW，也可以是4DW。以4DW的Header为例，TLP的Header长下面样子：</p>
<p><img src="http://jiali.clouddn.com/20200722_011.png" alt=""></p>
<p>红色区域为所有TLP Header公共部分，所有Header都有这些；其它则是跟具体的TLP相关。</p>
<p>注释：</p>
<p><strong>Fmt</strong>：Format, 表明该TLP是否带有数据，Header是3DW还是4DW；</p>
<p><strong>Type</strong>：TLP类型，上一节提到的，Memory Read, Memory Write, Configuration Read, Configuration Write, Message和Completion，等等；</p>
<p><strong>R：</strong> Reserved，为0；</p>
<p><strong>TC</strong>: Traffic Class，TLP也分三六九等，优先级高的先得到服务。这里是3比特，说明可以分为8个等级，0-7，TC默认是0，数字越大，优先级越高；</p>
<p><strong>Attr:</strong> Attrbiute, 属性，前后共三个bit，先不说；</p>
<p><strong>TH</strong>: TLP Processing Hints，先不说；</p>
<p><strong>TD</strong>: TLP Digest，之前说ECRC可选，如果这个这个bit置起来，说明该TLP包含ECRC，接收端应该做CRC校验；</p>
<p><strong>EP</strong>: Poisoned data, 有毒的数据，远离，哈哈；</p>
<p><strong>AT</strong>: Address Type，地址种类，先不说；</p>
<p><strong>Length</strong>： Payload数据长度，1~1024，单位DW（4byte），所以TLP最大数据长度是4KB; 该长度总是DW的整数倍，如果TLP的数据不是DW的整数倍（不是4Byte的整数倍），则需要用到两个域：Last DW BE 和 1st DW BE。</p>
<p><strong>存储器读写请求的TLP</strong></p>
<p>64位的处理器系统的存储器读写请求的TLP格式如下图</p>
<p><img src="http://jiali.clouddn.com/20200722_012.png" alt=""></p>
<p>32位的处理器系统的存储器读写请求的TLP格式如下图</p>
<p><img src="http://jiali.clouddn.com/20200722_013.png" alt=""></p>
<p>Requester ID字段包含了生成这个TLP报文的PCIe设备的总线号（Bus Number）、设备号（Device Number）和功能号（Function Number）。因此，Requester ID就是源地址，其格式如下：</p>
<p><img src="http://jiali.clouddn.com/20200722_014.png" alt=""></p>
<p>Address:目的地址。PCIe设备，进行DMA操作，往处理器的DDR读写数据时候，需要获取DDR的内存地址，来填充Address。</p>
<p><strong>注意：</strong></p>
<p>基于厂家FPGA 的PCIe开发，主要是做事务层开发工作，封装TLP，对TLP接收和发送进行处理。因此，熟悉事务层的存储器、I/O和配置读写请求TLP过程很重要。曾经，CPU写FPGA PCIe设备的BAR地址空间的某个寄存器，因为FPGA 不返回TLP，导致CPU卡住。</p>
<p><strong>Data Payload参数</strong> </p>
<p>Max_Payload_Size参数存放PCIe设备<strong>实际使用</strong>的TLP有效负载的最大值。<strong>该参数由PCIe链路两端的设备协商决定，是PCIe设备进行数据传送时，实际使用的参数</strong>。当PCIe设备发送数据报文时，设置Max_Payload_Size参数决定TLP的Data Payload 长度的最大值。</p>
<p>Max_Payload_Size_Supported参数表示一个PCIe设备中TLP有效负载的最大值，这是由PCIe设备的硬件逻辑决定，软件不能更改。</p>
<p>Max_Payload_Size和Max_Payload_Size_Supported分别在PCI Express Capability结构中的Device Capability和Device Control寄存器中定义。</p>
<p>Max_Payload_Size可以设置为128byte、256byte、512byte和1024byte.在FPGA实际应用中，需要配置Max_Payload_Size和<strong>TLP</strong>的Length字段。FPGA的Max_Payload_Size配置如下图所示。</p>
<p><img src="http://jiali.clouddn.com/20200722_010.png" alt=""></p>
<p><strong>注意：</strong></p>
<p>当PCIe设备接收TLP时，该TLP的最大有效负载不能超过Max_Payload_Size（就是Length字段不能超过Max_Payload_Size），如果Length字段超过Length字段，则接收TLP的PCIe设备认为TLP非法。因此一次TLP传输数据失败。曾经，FPGA进行DMA操作，往CPU系统的DDR写数据，因为一次性把很大的数据量填充到TLP中，所以导致，CPU收不到数据。</p>
<h2 id="PCIe设备的配置空间"><a href="#PCIe设备的配置空间" class="headerlink" title="PCIe设备的配置空间"></a>PCIe设备的配置空间</h2><p>0x00<del>0xff,这段地址空间共256byte，PCI\PCI-X\PCIe都包含了这256byte配置空间。大多数PCI设备仅支持0x00</del>0x3f，这64byte的配置空间。此外，0x40~0xff，这段配置空间，主要存放一些与MSI或者MSI-X中断管理和电源管理相关的Capability结构。大多数PCI设备不支持MSI\MSI-X中断，而PCIe设备必须支持MSI\MSI-X中断机制(<strong>大多是PCIe设备使用MSI中断</strong>)。</p>
<p>64byte的配置空间如下图：</p>
<p><img src="http://jiali.clouddn.com/20200721_004.png" alt=""></p>
<p>另外，PCIe设备支持0x100<del>0xfff这段扩展配置空间。因此PCIe设备的配置空间最大位4k。0x100</del>0xfff这段空间，存放PCIe设备所独有的一些Capability结构，PCI设备是不能使用这段空间（事实上，PCI设备仅支持0x00~0x3f这段配置空间）。</p>
<p>PCIe设备的配置空间如下图所示。</p>
<p><img src="http://jiali.clouddn.com/20200723_005.png" alt=""></p>
<p><strong>注意：</strong></p>
<p>在实际工程中，在FPGA PCIe核设置好BAR配置空间的大小，系统软件根据大小分配PCIe总线地址空间。FPGA配置如下图所示。</p>
<p><img src="http://jiali.clouddn.com/20200724_001.png" alt=""></p>
<h2 id="MSI中断机制"><a href="#MSI中断机制" class="headerlink" title="MSI中断机制"></a>MSI中断机制</h2><h3 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h3><p>在PCI总线中，所有需要提交的中断请求，必须通过INTx引脚向处理器提交中断请求；而在PCIe总线中，PCIe设备向处理器提交中断，是通过MSI机制实现，不需要通过INTx引脚。</p>
<p>MSI机制就是使用存储器写请求TLP向处理器提交中断请求。这种MSI消息，也简称为MSI报文。此外MSI中断最多支持32个中断。32位和64位的MSI 报文协议结构如下图所示。</p>
<p><img src="http://jiali.clouddn.com/20200724_002.png" alt=""></p>
<p><strong>Message Control:</strong> 该字段存放当前PCIe设备使用的MSI机制进行中断请求的状态与控制信息。</p>
<p><strong>Message Address:</strong> 该字段存放MSI存储器写事务的目的地址低32位。</p>
<p><strong>Message Upper Address:</strong> 该字段存放MSI存储器写事务的目的地址高32位。</p>
<p>重点关注Message Control字段含义，如下图所示。</p>
<p><img src="http://jiali.clouddn.com/20200724_003.png" alt=""></p>
<h3 id="工程实践"><a href="#工程实践" class="headerlink" title="工程实践"></a>工程实践</h3><p>FPGA PCIe MSI控制器配置寄存器地址，如下图所示。</p>
<p><img src="http://jiali.clouddn.com/20200724_004.png" alt=""></p>
<p>MSI Control Register，如下图所示。</p>
<p><img src="http://jiali.clouddn.com/20200724_005.png" alt=""></p>
<p>通过MSI控制寄存器可将MSI中断配置成多消息中断模式，中断个数可通过Multiple Message Enable 配置，只读字段Multiple Message Capable表示系统分配给PCIe设备的中断向量数量。</p>
<p><strong>注意：</strong></p>
<p>曾经FPGA没有配置字段Multiple Message Capable，因为该字段默认为0,所以，无论怎么配置Multiple Message Enable，MSI只产生1个中断（0号MSI中断）。</p>
<p>FPGA PCIe设备中，cfg_interrupt_msi_int MSI各中断寄存器如下表所示。</p>
<p><img src="http://jiali.clouddn.com/20200724_006.png" alt=""></p>
<p>只要置位中断寄存器对应的Bit,就可以触发中断。例如，本次使用0，1，2号中断，在相应位置位就可以触发中断。</p>
<p>Linux MSI中断配置如下</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;&#x2F;1、申请四个中断</span><br><span class="line">pci_alloc_irq_vectors(pdev,1,4,PCI_IRQ_MSI);</span><br><span class="line">&#x2F;&#x2F;2、设置Multiple Message Enable字段为4</span><br><span class="line">control |&#x3D; 0x0020;</span><br><span class="line">pci_write_config_word(pdev,pdev-&gt;msi_cap+2,control);</span><br><span class="line">&#x2F;&#x2F;注册中断</span><br><span class="line">irq &#x3D; pci_irq_vector(pdev,0);</span><br><span class="line">err &#x3D; request_irq(irq, ps_pcie_intr_handler_no_msix, IRQF_SHARED, &quot;PCIE PS PCIe DMA Device&quot;, ptr_dma_desc_temp);</span><br><span class="line">irq &#x3D; pci_irq_vector(pdev,1);	</span><br><span class="line">err &#x3D; request_irq(irq, ps_pcie_intr_handler_no_msix_1, IRQF_SHARED, &quot;PCIE PS PCIe DMA Device_1&quot;, ptr_dma_desc_temp);</span><br><span class="line">irq &#x3D; pci_irq_vector(pdev,2);</span><br><span class="line">err &#x3D; request_irq(irq, ps_pcie_intr_handler_no_msix_2, IRQF_SHARED, &quot;PCIE PS PCIe DMA Device2&quot;, ptr_dma_desc_temp);</span><br><span class="line">&#x2F;&#x2F;编写中断函数</span><br><span class="line">略。。。</span><br></pre></td></tr></table></figure>









<p>参考：</p>
<p><a href="https://www.cnblogs.com/YINBin/p/10946247.html" target="_blank" rel="noopener">PCIe总线（协议简述）</a></p>
<p><a href="https://zhuanlan.zhihu.com/p/26172972" target="_blank" rel="noopener">深入PCI与PCIe之一：硬件篇</a></p>
<p><a href="http://xilinx.eetrend.com/d6-xilinx/blog/2018-08/13327.html" target="_blank" rel="noopener">PCIe学习（一）：PCIe基础及生成PIO例程分析</a></p>
<p><a href="http://www.ssdfans.com/?p=8211" target="_blank" rel="noopener">老男孩读PCIe之一：从PCIe速度说起</a></p>
<p><a href="http://www.ssdfans.com/?p=8213" target="_blank" rel="noopener">老男孩读PCIe之二：PCIe拓扑结构</a></p>
<p><a href="http://www.ssdfans.com/?p=8214" target="_blank" rel="noopener">老男孩读PCIe之三：PCIe分层结构</a></p>
<p><a href="http://www.ssdfans.com/?p=8215" target="_blank" rel="noopener">老男孩读PCIe之四：TLP类型</a></p>
<p><a href="http://www.ssdfans.com/?p=8212" target="_blank" rel="noopener">老男孩读PCIe之五：TLP结构</a></p>
<p><a href="http://www.ssdfans.com/?p=8210" target="_blank" rel="noopener">老男孩读PCIe之六：配置和地址空间</a></p>
<p><a href="http://www.ssdfans.com/?p=8216" target="_blank" rel="noopener">老男孩读PCIe之七：TLP的路由</a></p>
]]></content>
      <categories>
        <category>linux</category>
        <category>Driver</category>
        <category>PCIe</category>
      </categories>
      <tags>
        <tag>PCIe</tag>
      </tags>
  </entry>
  <entry>
    <title>PCI总线基础知识</title>
    <url>/2020/07/20/Linux/Driver/PCIe/PCI%E6%80%BB%E7%BA%BF%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/</url>
    <content><![CDATA[<p>[TOC]</p>
<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>PCI，英文全称：PeripheralComponent Interconnect，外围组件互联，由Intel于1991年提出。随着Intel Pentium处理器诞生而迅速发展，当时几乎所有的外围设备，从硬盘控制器、声卡、显卡和网卡，都使用PCI插槽来连接到计算机的主板上。计算机的PCI总线外设拓扑结构如下图所示。</p>
<p><img src="http://jiali.clouddn.com/20200720_002.png" alt="20200720_002"></p>
<h2 id="PCI基础知识"><a href="#PCI基础知识" class="headerlink" title="PCI基础知识"></a>PCI基础知识</h2><h3 id="PCI是什么？"><a href="#PCI是什么？" class="headerlink" title="PCI是什么？"></a>PCI是什么？</h3><p>PCI总线是并行、同步、数据地址复用的总线。在一个时钟周期内32个bit（或者64bit）同时被传输，地址和数据在一个时钟周期内按照协议，分别一次被传输。32bit/33MHz峰值带宽为132MB/s，64bit/66MHz峰值带宽为532MB/s。引脚定义如下：</p>
<p><img src="http://jiali.clouddn.com/20200720_001.png" alt="20200720_001"></p>
<p>特点：</p>
<ul>
<li>PCI总线地址空间与处理器的地址空间隔离：通过HOST主桥将PCI总线地址空间与CPU存储器域地址空间隔离。处理器访问PCI设备，先通过HOST主桥将处理器域的地址转换为PCI总线地址，同理，PCI设备进行DMA操作来传输数据时，也是先通过主桥将PCI总线地址转换为处理器存储器域地址。PCI总线地址是独立的地址空间，这跟处理器的存储器域地址空间不同。</li>
<li>可扩展性：同过HOST主桥引出一条PCI总线，然后在通过PCI桥引出一系列PCI总线，这样就构成一颗以HOST主桥为根的PCI总线树。</li>
<li>动态配置机制：每一个PCI设备都有独立的配置空间，在配置空间中包含了该设备在PCI总线地址空间中使用的物理基地址。这个基地址，可以通过软件动态分配，从而保证了每一个PCI设备使用的PCI总线地址不相同。</li>
<li>总线带宽：32bit/33MHz的PCI总线可以提供132MB/s的峰值带宽，64bit/66MHz的PCI总线可以提供532MB/s的峰值带宽。</li>
<li>共享总线机制：多个PCI设备可以共享一条PCI总线，PCI设备通过仲裁获得PCI总线的使用权后，才能进程数据传输。</li>
<li>中断机制。PCI总线上的设备可以通过四根中断请求信号INTA-D#向处理器提交中断请求。还可以通过MSI机制（该机制使用存储器写总线事务传递中断请求信号）提交中断请求。</li>
</ul>
<h3 id="PCI总线架构"><a href="#PCI总线架构" class="headerlink" title="PCI总线架构"></a>PCI总线架构</h3><p>在一个处理器系统中，PCI总线相关模块如下图所示。</p>
<p><img src="http://jiali.clouddn.com/20200720_003.png" alt="20200720_003"></p>
<h4 id="PCI总线相关模块"><a href="#PCI总线相关模块" class="headerlink" title="PCI总线相关模块"></a>PCI总线相关模块</h4><p><strong>HOST主桥</strong></p>
<p>HOST主桥主要功能是隔离CPU系统的存储器域与CPU系统的PCI总线域，并完成CPU与PCI设备间的数据交换。数据交换主要的类型：处理器访问PCI设备的地址空间和PCI设备使用DMA机制访问DDR内存。</p>
<p><strong>PCI总线</strong></p>
<p>有两个概念：PCI总线和PCI总线树。PCI总线是由桥引出来的一条总线，而PCI总线树是以HOST主桥为根的一系列PCI总线组成的。所有PCI桥引出总线地址共享PCI总线域（一颗PCI总线树）的地址。</p>
<p><strong>PCI设备</strong></p>
<p>三类设备：PCI主设备、PCI从设备和桥设备。</p>
<p>从设备：只能被动地接收来自HOST主桥或者其他PCI设备的读写请求</p>
<p>主设备:通过总线仲裁获得PCI总线的使用权，主动地向其他PCI设备或者主存储器（DDR）发起存储器读写请求。</p>
<p>桥设备：管理下游的PCI总线，并转发上下游总线之间的总线事务。</p>
<p>一个PCI设备可以既是主设备也是从设备，但是在同一个时刻，这个PCI设备只能是主设备或从设备。PCI总线规范把这类PCI主从设备称为PCI Agent设备。</p>
<p><strong>HOST处理器：</strong>CPU</p>
<p><strong>PCI总线负载</strong>：PCI总线能挂接的负载域总线频率相关。如下图所示。</p>
<p><img src="http://jiali.clouddn.com/20200721_001.png" alt=""></p>
<h4 id="PCI总线事务"><a href="#PCI总线事务" class="headerlink" title="PCI总线事务"></a>PCI总线事务</h4><p>CPU与PCI设备之间数据传输，通过PCI总线地址完成。CPU对PCI设备的地址空间进行读写，先发起存储器域地址读写，然后通过HOST主桥转换为PCI总线地址；PCI设备对CPU的DDR进行DMA操作，使用的目的地址是PCI总线地址，而不是CPU的存储器域地址，由HOST主桥完成PCI域地址到CPU的存储器域的地址转换。</p>
<ol>
<li><p><strong>存储器读写总线事务</strong></p>
<p>（1）事务类型</p>
<ul>
<li><p>CPU对PCI的BAR空间地址进行数据读写</p>
</li>
<li><p>PCI设备之间的数据传输</p>
</li>
<li><p>PCI设备对CPU的DDR进行DMA读写操作。</p>
</li>
</ul>
<p>（2）PCI总线传送方式:Posted 和Non-Posted</p>
<p>Posted:PCI主设备向PCI目标设备进行数据传递时，当数据到达PCI桥后，PCI桥接管该总线事务，并转发到下游总线，然后，该PCI桥上游的PCI总线可以结束当前总线事务，释放了PCI使用权。在一定程度上解决PCI总线拥塞问题。</p>
<p>Non-Posted:PCI主设备向PCI目标设备进行数据传递时，数据必须到达目的后，才能结束当前总线事务。</p>
</li>
<li><p><strong>CPU访问CPI设备</strong></p>
<p>（1）CPU对PCI设备的数据访问形式</p>
<ul>
<li>CPU向PCI设备发起存储器和I/O读写请求</li>
</ul>
</li>
</ol>
<ul>
<li><h2 id="CPU对PCI设备的配置空间进行读写。"><a href="#CPU对PCI设备的配置空间进行读写。" class="headerlink" title="CPU对PCI设备的配置空间进行读写。"></a>CPU对PCI设备的配置空间进行读写。</h2><p> （2）CPU向PCI设备发起存储器读写事务过程</p>
<p> ​    首先，CPU在初始化时，需要将PCI设备使用的BAR空间映射到存储器域地址空间。之后，CPU通过存储器读写指令访问存储器地址，HOST主桥将存储器地址请求转换为对PCI总线地址的请求，然后发给目标设备。注意：CPU只能使用CPU的存储器域的地址，而PCI设备只能使用PCI总线域的地址。</p>
<p> （3）I/O读写总线事务</p>
<p> ​    以X86处理器介绍CPU访问PCI设备的I/O地址空间的过程。X86处理器，具有独立的I/O地址空间，可以将PCI设备的I/O地址映射到CPU的I/O地址空间，之后    使用IN\OUT指令访问CPU自己的I/O地址，然后通过HOST主桥将CPU的I/O地址转换为PCI总线域的I/O地址，最后，使用PCI总线的I/O总线事务对PCI设备的    I/O地址访问。</p>
</li>
</ul>
<ol start="3">
<li><p><strong>PCI设备读写CPU的DDR存储器</strong></p>
<p>PCI设备与CPU的DDR直接进行数据交换的过程被称为DMA。PCI设备进行DMA操作时候，需要获得数据传送的目的地址（已经与CPU的DDR内存地址映射的PCI总线地址）。HOST主桥负责完成PCI总线地址到CPU存储器域地址的转换，并向存储器控制器发起对DDR读写请求。注意，PCI设备不能直接访问没有经过HOST主桥映射的DDR内存地址。</p>
</li>
</ol>
<h2 id="PCI总线配置"><a href="#PCI总线配置" class="headerlink" title="PCI总线配置"></a>PCI总线配置</h2><h3 id="弄清几个区域概念"><a href="#弄清几个区域概念" class="headerlink" title="弄清几个区域概念"></a>弄清几个区域概念</h3><p>在一个处理器系统中，存在PCI总线域和存储器域。通过HOST主桥，将存储器域和PCI域隔离，形成各自独立的地址空间。它们之间的关系如下图所示。</p>
<p><img src="http://jiali.clouddn.com/20200721_003.png" alt=""></p>
<ol>
<li><p>存储器域</p>
<p>存储器域包括了CPU内部的通用寄存器、存储器控制器的寄存器、内存地址空间和外设地址空间。</p>
<p>2.PCI总线域</p>
</li>
</ol>
<p>​    PCI总线域由PCI设备所能直接访问的地址空间组成。在一个处理器系统中，存在几个HOST主桥，就存在几个PCI总线域。</p>
<p><strong>注释：</strong></p>
<p>（1）处理器访问PCI总线域地址空间时，首先需要访问存储器域的地址空间，在通过HOST主桥将存储器地址转换为PCI总线地址，之后，才能进入PCI总线域进行数据交换。PCI设备使用的PCI总线域地址空间保存在各自的BAR寄存器中。这些PCI总线地址空间需要在初始化时映射成为存储器域的地址空间，之后处理器才能访问BAR空间。</p>
<p>（2）PCI设备访问存储器域时，首先需要访问PCI总线域的地址空间，在通过HOST主桥将PCI总线地址转换为存储器地址，之后，才能跟CPU进行数据交换。因此，处理器需要通过HOST主桥将这个PCI总线地址反向映射为存储器地址。PCI设备不能访问在PCI总线域中没有进行映射的存储器域地址空间。</p>
<h3 id="PCI总线初始化"><a href="#PCI总线初始化" class="headerlink" title="PCI总线初始化"></a>PCI总线初始化</h3><h4 id="PCI设备配置空间寄存器地址"><a href="#PCI设备配置空间寄存器地址" class="headerlink" title="PCI设备配置空间寄存器地址"></a>PCI设备配置空间寄存器地址</h4><p>在PCI设备配置空间中出现的地址都是PCI总线地址，属于PCI总线域地址空间。系统软件需要完成这些寄存器的初始化。PCI  Agent设备的配置空间如下图所示。</p>
<p><img src="http://jiali.clouddn.com/20200721_004.png" alt=""></p>
<ul>
<li><p>Device ID 和Vendor ID寄存器:Vendor ID代表厂家，Device ID:代表厂家生产的具体设备</p>
</li>
<li><p>Base Address Register0-5寄存器：这组寄存器保存PCI设备使用的PCI总线域地址空间的基地址。</p>
<p>注释：</p>
<p>在PCI设备的配置空间中，有6个BAR寄存器。每一个BAR寄存器都与PCI设备使用的某一组PCI总线地址空间对应，BAR寄存器保存该组PCI总线地址空间的基地址，该组PCI总线地址空间也称为BAR空间。BAR空间可以存放I/O地址空间，也可以存放存储器地址空间。（是PCI总线的地址，不是CPU的存储器域地址）</p>
</li>
</ul>
<p>问：</p>
<p>1、如何访问这些配置空间？</p>
<p>在MPC8548处理器的HOST主桥中，与PCI设备配置空间相关的寄存器由CFG_ADDR、CFG_DATA和INT-ACK寄存器组成。系统软件使用CFG_ADDR、CFG_DATA寄存器访问PCI设备的配置空间</p>
<h4 id="PCI总线树BUS总线号初始化"><a href="#PCI总线树BUS总线号初始化" class="headerlink" title="PCI总线树BUS总线号初始化"></a>PCI总线树BUS总线号初始化</h4><p>在一个处理器系统中，每一个HOST主桥都推出一颗PCI总线树。在一块PCI总线树中有多少个PCI桥就含有多少条PCI总线。系统软件在遍历当前PCI总线树时，首先需要对这些PCI总线进行编号，即初始化PCI桥的Primary、Secondary和Subordinate Bus Number寄存器。</p>
<p>一般，将与HOST主桥直接相连的PCI总线命名为PCI总线0，然后，系统软件使用DFS算法，依次对其他PCI总线进行编号。最后得到的PCI总线结构如下图所示。</p>
<p><img src="http://jiali.clouddn.com/20200721_007.png" alt=""></p>
<h4 id="BAR空间的初始化"><a href="#BAR空间的初始化" class="headerlink" title="BAR空间的初始化"></a>BAR空间的初始化</h4><p>系统软件对PCI总线进行配置时，首先获得BAR寄存器中的初始化信息，之后，根据处理器系统的配置，将合理的PCI总线域的某个地址空间的基地址写入BAR寄存器中。</p>
<p>当处理器访问PCI设备的BAR空间时，需要使用BAR寄存器提供的基地址。注意的是，处理器使用存储器域的地址，不能直接使用<strong>BAR中的基地址+偏移</strong>的方式访问BAR空间，而应该将BAR中的基地址转换为CPU存储器域的地址。</p>
<p>linux中使用下面的接口获取BAR中的基地址对应的存储器域地址</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">pci_resource_start();</span><br><span class="line">原型如下：</span><br><span class="line">#define pci_resource_start(dev, bar)	((dev)-&gt;resource[(bar)].start)</span><br></pre></td></tr></table></figure>

<p><strong>PCI设备BAR空间分配例子</strong></p>
<p>假设在HOST主桥中，存储器域域PCI总线域的映射关系如下图所示。</p>
<p><img src="http://jiali.clouddn.com/20200721_005.png" alt=""></p>
<p>BAR空间映射：0xf000-0000<del>0xf7ff-ffff —&gt;0x7000-0000</del>0x7800-0000 </p>
<p>DMA操作的内存映射：0x8000-0000<del>0xffff-ffff —&gt; 0x0000-0000</del>0x7fff-ffff</p>
<p>系统软件根据建立起的映射关系，初始化BAR寄存器，完成后如下图所示。</p>
<p><img src="http://jiali.clouddn.com/20200721_006.png" alt=""></p>
<h2 id="PCI总线数据传输"><a href="#PCI总线数据传输" class="headerlink" title="PCI总线数据传输"></a>PCI总线数据传输</h2><h3 id="处理器到PCI设备的数据传送"><a href="#处理器到PCI设备的数据传送" class="headerlink" title="处理器到PCI设备的数据传送"></a>处理器到PCI设备的数据传送</h3><p>略。</p>
<h3 id="PCI设备的DMA操作"><a href="#PCI设备的DMA操作" class="headerlink" title="PCI设备的DMA操作"></a>PCI设备的DMA操作</h3><p>略。</p>
<p>参考：</p>
<p><a href="https://zhuanlan.zhihu.com/p/26172972" target="_blank" rel="noopener">深入PCI与PCIe之一：硬件篇</a></p>
<p><a href="https://blog.csdn.net/qimoDIY/article/details/89784560" target="_blank" rel="noopener">接口技术【1】PCIe入门简介</a></p>
<p><a href="https://www.twblogs.net/a/5b7ec5632b717767c6abb3f2" target="_blank" rel="noopener">浅析PCI配置空间</a></p>
]]></content>
      <categories>
        <category>linux</category>
        <category>Driver</category>
        <category>PCIe</category>
      </categories>
      <tags>
        <tag>PCIe</tag>
      </tags>
  </entry>
  <entry>
    <title>linux查看PCIe的配置空间</title>
    <url>/2020/07/25/Linux/Driver/PCIe/linux%E6%9F%A5%E7%9C%8BPCIe%E7%9A%84%E9%85%8D%E7%BD%AE%E7%A9%BA%E9%97%B4/</url>
    <content><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>操作系统完成PCI/PCIe的初始化后，建立了PCI总线树。在Linux中，用户空间如何访问PCI/PCIe的配置空间和查看PCIe设备信息呢？本节重点讲在应用层读取配置空间和显示PCI/PCIe设备信息。</p>
<h2 id="查看配置空间信息"><a href="#查看配置空间信息" class="headerlink" title="查看配置空间信息"></a>查看配置空间信息</h2><p>读取PCIe设备配置空间的命令</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">lspci</span><br></pre></td></tr></table></figure>

<p>lspci 是一个用来显示系统中所有PCI总线设备或连接到该总线上的所有设备的工具。</p>
<p>常用的几个参数：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">-v</span><br><span class="line">使得 lspci 以冗余模式显示所有设备的详细信息。</span><br><span class="line">-vv</span><br><span class="line">使得 lspci 以过冗余模式显示更详细的信息 (事实上是 PCI 设备能给出的所有东西)。这些数据的确切意义没有在此手册页中解释，如果你想知道更多，请参照 &#x2F;usr&#x2F;include&#x2F;linux&#x2F;pci.h 或者 PCI 规范。</span><br><span class="line">-vvv 显示设备所有可解析的信息</span><br><span class="line">-n</span><br><span class="line">以数字形式显示 PCI 生产厂商和设备号，而不是在 PCI ID 数据库中查找它们。</span><br><span class="line">-x</span><br><span class="line">以十六进制显示 配置空间 (configuration space) 的前64个字节映像 (标准头部信息)。此参数对调试驱动和 lspci 本身很有用。</span><br><span class="line">-xxx</span><br><span class="line">以十六进制显示所有配置空间的256Byte映像。此选项只有 root 可用，并且很多 PCI 设备在你试图读取配置空间的未定义部分时会崩溃 (此操作可能不违反PCI标准，但是它至少非常愚蠢)。</span><br><span class="line">-xxxx 以16进制显示整个PCIe配置空间（4096字节）。</span><br><span class="line">-t</span><br><span class="line">以树形方式显示包含所有总线、桥、设备和它们的连接的图表。</span><br><span class="line">-s [[]:][][.[]]</span><br><span class="line">仅显示指定总线、插槽上的设备或设备上的功能块信息。设备地址的任何部分都可以忽略，或以「*」代替 (意味著所有值)。所有数字都是十六进制。例如：「0：」指的是在0号总线上的所有设备；「0」指的是在任意总线上0号设备的所有功能块；「0.3」选择 了所有总线上0号设备的第三个功能块；「.4」则是只列出每一设备上的第四个功能块。</span><br><span class="line">-d []:[]</span><br><span class="line">只显示指定生产厂商和设备 ID 的设备。 这两个 ID 都以十六进制表示，可以忽略或者以「*」代替 (意味著所有值)。</span><br></pre></td></tr></table></figure>

<p>操作示例</p>
<p>示例1：只是简单显示目前所有的硬件设备</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">~# lspci </span><br><span class="line">00:00.0 Host bridge: Intel Corporation Xeon E3-1200 v6&#x2F;7th Gen Core Processor Host Bridge&#x2F;DRAM Registers (rev 05)</span><br><span class="line">00:01.0 PCI bridge: Intel Corporation Xeon E3-1200 v5&#x2F;E3-1500 v5&#x2F;6th Gen Core Processor PCIe Controller (x16) (rev 05)</span><br><span class="line">00:08.0 System peripheral: Intel Corporation Xeon E3-1200 v5&#x2F;v6 &#x2F; E3-1500 v5 &#x2F; 6th&#x2F;7th Gen Core Processor Gaussian Mixture Model</span><br><span class="line">00:14.0 USB controller: Intel Corporation 100 Series&#x2F;C230 Series Chipset Family USB 3.0 xHCI Controller (rev 31)</span><br><span class="line">00:14.2 Signal processing controller: Intel Corporation 100 Series&#x2F;C230 Series Chipset Family Thermal Subsystem (rev 31)</span><br><span class="line">00:15.0 Signal processing controller: Intel Corporation 100 Series&#x2F;C230 Series Chipset Family Serial IO I2C Controller #0 (rev 31)</span><br><span class="line">00:15.1 Signal processing controller: Intel Corporation 100 Series&#x2F;C230 Series Chipset Family Serial IO I2C Controller #1 (rev 31)</span><br><span class="line">00:16.0 Communication controller: Intel Corporation 100 Series&#x2F;C230 Series Chipset Family MEI Controller #1 (rev 31)</span><br><span class="line">00:16.3 Serial controller: Intel Corporation 100 Series&#x2F;C230 Series Chipset Family KT Redirection (rev 31)</span><br><span class="line">00:17.0 SATA controller: Intel Corporation Q170&#x2F;Q150&#x2F;B150&#x2F;H170&#x2F;H110&#x2F;Z170&#x2F;CM236 Chipset SATA Controller [AHCI Mode] (rev 31)</span><br><span class="line">00:1c.0 PCI bridge: Intel Corporation 100 Series&#x2F;C230 Series Chipset Family PCI Express Root Port #6 (rev f1)</span><br><span class="line">00:1d.0 PCI bridge: Intel Corporation 100 Series&#x2F;C230 Series Chipset Family PCI Express Root Port #9 (rev f1)</span><br><span class="line">00:1f.0 ISA bridge: Intel Corporation Q170 Chipset LPC&#x2F;eSPI Controller (rev 31)</span><br><span class="line">00:1f.2 Memory controller: Intel Corporation 100 Series&#x2F;C230 Series Chipset Family Power Management Controller (rev 31)</span><br><span class="line">00:1f.3 Audio device: Intel Corporation 100 Series&#x2F;C230 Series Chipset Family HD Audio Controller (rev 31)</span><br><span class="line">00:1f.4 SMBus: Intel Corporation 100 Series&#x2F;C230 Series Chipset Family SMBus (rev 31)</span><br><span class="line">00:1f.6 Ethernet controller: Intel Corporation Ethernet Connection (2) I219-LM (rev 31)</span><br><span class="line">01:00.0 VGA compatible controller: NVIDIA Corporation GP107 [GeForce GTX 1050 Ti] (rev a1)</span><br><span class="line">01:00.1 Audio device: NVIDIA Corporation GP107GL High Definition Audio Controller (rev a1)</span><br><span class="line">02:00.0 Ethernet controller: Intel Corporation I211 Gigabit Network Connection (rev 03)</span><br><span class="line">03:00.0 Memory controller: Xilinx Corporation Device 8034</span><br></pre></td></tr></table></figure>

<p>示例2：显示所有设备详细的信息</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">~# lspci -v</span><br><span class="line">00:00.0 Host bridge: Intel Corporation Xeon E3-1200 v6&#x2F;7th Gen Core Processor Host Bridge&#x2F;DRAM Registers (rev 05)</span><br><span class="line">	Subsystem: Intel Corporation Xeon E3-1200 v6&#x2F;7th Gen Core Processor Host Bridge&#x2F;DRAM Registers</span><br><span class="line">	Flags: bus master, fast devsel, latency 0</span><br><span class="line">	Capabilities: [e0] Vendor Specific Information: Len&#x3D;10 &lt;?&gt;</span><br><span class="line"></span><br><span class="line">00:01.0 PCI bridge: Intel Corporation Xeon E3-1200 v5&#x2F;E3-1500 v5&#x2F;6th Gen Core Processor PCIe Controller (x16) (rev 05) (prog-if 00 [Normal decode])</span><br><span class="line">	Flags: bus master, fast devsel, latency 0, IRQ 121</span><br><span class="line">	Bus: primary&#x3D;00, secondary&#x3D;01, subordinate&#x3D;01, sec-latency&#x3D;0</span><br><span class="line">	I&#x2F;O behind bridge: 0000e000-0000efff</span><br><span class="line">	Memory behind bridge: de000000-df0fffff</span><br><span class="line">	Prefetchable memory behind bridge: 00000000c0000000-00000000d1ffffff</span><br><span class="line">	Capabilities: [88] Subsystem: Intel Corporation Skylake PCIe Controller (x16)</span><br><span class="line">	Capabilities: [80] Power Management version 3</span><br><span class="line">	Capabilities: [90] MSI: Enable+ Count&#x3D;1&#x2F;1 Maskable- 64bit-</span><br><span class="line">	Capabilities: [a0] Express Root Port (Slot+), MSI 00</span><br><span class="line">	Capabilities: [100] Virtual Channel</span><br><span class="line">	Capabilities: [140] Root Complex Link</span><br><span class="line">	Capabilities: [d94] #19</span><br><span class="line">	Kernel driver in use: pcieport</span><br><span class="line">	Kernel modules: shpchp</span><br><span class="line"></span><br><span class="line">00:08.0 System peripheral: Intel Corporation Xeon E3-1200 v5&#x2F;v6 &#x2F; E3-1500 v5 &#x2F; 6th&#x2F;7th Gen Core Processor Gaussian Mixture Model</span><br><span class="line">	Subsystem: Intel Corporation Skylake Gaussian Mixture Model</span><br><span class="line">	Flags: fast devsel, IRQ 11</span><br><span class="line">	Memory at df252000 (64-bit, non-prefetchable) [disabled] [size&#x3D;4K]</span><br><span class="line">	Capabilities: [90] MSI: Enable- Count&#x3D;1&#x2F;1 Maskable- 64bit-</span><br><span class="line">	Capabilities: [dc] Power Management version 2</span><br><span class="line">	Capabilities: [f0] PCI Advanced Features</span><br><span class="line"></span><br><span class="line">00:14.0 USB controller: Intel Corporation 100 Series&#x2F;C230 Series Chipset Family USB 3.0 xHCI Controller (rev 31) (prog-if 30 [XHCI])</span><br><span class="line">	Subsystem: Intel Corporation Sunrise Point-H USB 3.0 xHCI Controller</span><br><span class="line">	Flags: bus master, medium devsel, latency 0, IRQ 124</span><br><span class="line">	Memory at df230000 (64-bit, non-prefetchable) [size&#x3D;64K]</span><br><span class="line">	Capabilities: [70] Power Management version 2</span><br><span class="line">	Capabilities: [80] MSI: Enable+ Count&#x3D;1&#x2F;8 Maskable- 64bit+</span><br><span class="line">	Kernel driver in use: xhci_hcd</span><br><span class="line"></span><br><span class="line">00:14.2 Signal processing controller: Intel Corporation 100 Series&#x2F;C230 Series Chipset Family Thermal Subsystem (rev 31)</span><br><span class="line">	Subsystem: Intel Corporation Sunrise Point-H Thermal subsystem</span><br><span class="line">	Flags: fast devsel, IRQ 18</span><br><span class="line">	Memory at df251000 (64-bit, non-prefetchable) [size&#x3D;4K]</span><br><span class="line">	Capabilities: [50] Power Management version 3</span><br><span class="line">	Capabilities: [80] MSI: Enable- Count&#x3D;1&#x2F;1 Maskable- 64bit-</span><br><span class="line">	Kernel driver in use: intel_pch_thermal</span><br><span class="line">	Kernel modules: intel_pch_thermal</span><br><span class="line"></span><br><span class="line">00:15.0 Signal processing controller: Intel Corporation 100 Series&#x2F;C230 Series Chipset Family Serial IO I2C Controller #0 (rev 31)</span><br><span class="line">	Subsystem: Intel Corporation Sunrise Point-H Serial IO I2C Controller</span><br><span class="line">	Flags: bus master, fast devsel, latency 0, IRQ 16</span><br><span class="line">	Memory at df250000 (64-bit, non-prefetchable) [size&#x3D;4K]</span><br><span class="line">	Capabilities: [80] Power Management version 3</span><br><span class="line">	Capabilities: [90] Vendor Specific Information: Len&#x3D;14 &lt;?&gt;</span><br><span class="line">	Kernel driver in use: intel-lpss</span><br><span class="line">	Kernel modules: intel_lpss_pci</span><br><span class="line"></span><br><span class="line">00:15.1 Signal processing controller: Intel Corporation 100 Series&#x2F;C230 Series Chipset Family Serial IO I2C Controller #1 (rev 31)</span><br><span class="line">	Subsystem: Intel Corporation Sunrise Point-H Serial IO I2C Controller</span><br><span class="line">	Flags: bus master, fast devsel, latency 0, IRQ 17</span><br><span class="line">	Memory at df24f000 (64-bit, non-prefetchable) [size&#x3D;4K]</span><br><span class="line">	Capabilities: [80] Power Management version 3</span><br><span class="line">	Capabilities: [90] Vendor Specific Information: Len&#x3D;14 &lt;?&gt;</span><br><span class="line">	Kernel driver in use: intel-lpss</span><br><span class="line">	Kernel modules: intel_lpss_pci</span><br><span class="line"></span><br><span class="line">00:16.0 Communication controller: Intel Corporation 100 Series&#x2F;C230 Series Chipset Family MEI Controller #1 (rev 31)</span><br><span class="line">	Subsystem: Intel Corporation Sunrise Point-H CSME HECI</span><br><span class="line">	Flags: bus master, fast devsel, latency 0, IRQ 324</span><br><span class="line">	Memory at df24e000 (64-bit, non-prefetchable) [size&#x3D;4K]</span><br><span class="line">	Capabilities: [50] Power Management version 3</span><br><span class="line">	Capabilities: [8c] MSI: Enable+ Count&#x3D;1&#x2F;1 Maskable- 64bit+</span><br><span class="line">	Kernel driver in use: mei_me</span><br><span class="line">	Kernel modules: mei_me</span><br><span class="line"></span><br><span class="line">00:16.3 Serial controller: Intel Corporation 100 Series&#x2F;C230 Series Chipset Family KT Redirection (rev 31) (prog-if 02 [16550])</span><br><span class="line">	Subsystem: Intel Corporation Sunrise Point-H KT Redirection</span><br><span class="line">	Flags: 66MHz, fast devsel, IRQ 19</span><br><span class="line">	I&#x2F;O ports at f060 [size&#x3D;8]</span><br><span class="line">	Memory at df24d000 (32-bit, non-prefetchable) [size&#x3D;4K]</span><br><span class="line">	Capabilities: [40] MSI: Enable- Count&#x3D;1&#x2F;1 Maskable- 64bit+</span><br><span class="line">	Capabilities: [50] Power Management version 3</span><br><span class="line">	Kernel driver in use: serial</span><br><span class="line"></span><br><span class="line">00:17.0 SATA controller: Intel Corporation Q170&#x2F;Q150&#x2F;B150&#x2F;H170&#x2F;H110&#x2F;Z170&#x2F;CM236 Chipset SATA Controller [AHCI Mode] (rev 31) (prog-if 01 [AHCI 1.0])</span><br><span class="line">	Subsystem: Intel Corporation Sunrise Point-H SATA controller [AHCI mode]</span><br><span class="line">	Flags: bus master, 66MHz, medium devsel, latency 0, IRQ 317</span><br><span class="line">	Memory at df248000 (32-bit, non-prefetchable) [size&#x3D;8K]</span><br><span class="line">	Memory at df24c000 (32-bit, non-prefetchable) [size&#x3D;256]</span><br><span class="line">	I&#x2F;O ports at f050 [size&#x3D;8]</span><br><span class="line">	I&#x2F;O ports at f040 [size&#x3D;4]</span><br><span class="line">	I&#x2F;O ports at f020 [size&#x3D;32]</span><br><span class="line">	Memory at df24b000 (32-bit, non-prefetchable) [size&#x3D;2K]</span><br><span class="line">	Capabilities: [80] MSI: Enable+ Count&#x3D;1&#x2F;1 Maskable- 64bit-</span><br><span class="line">	Capabilities: [70] Power Management version 3</span><br><span class="line">	Capabilities: [a8] SATA HBA v1.0</span><br><span class="line">	Kernel driver in use: ahci</span><br><span class="line">	Kernel modules: ahci</span><br><span class="line"></span><br><span class="line">00:1c.0 PCI bridge: Intel Corporation 100 Series&#x2F;C230 Series Chipset Family PCI Express Root Port #6 (rev f1) (prog-if 00 [Normal decode])</span><br><span class="line">	Flags: bus master, fast devsel, latency 0, IRQ 122</span><br><span class="line">	Bus: primary&#x3D;00, secondary&#x3D;02, subordinate&#x3D;02, sec-latency&#x3D;0</span><br><span class="line">	I&#x2F;O behind bridge: 0000d000-0000dfff</span><br><span class="line">	Memory behind bridge: df100000-df1fffff</span><br><span class="line">	Capabilities: [40] Express Root Port (Slot+), MSI 00</span><br><span class="line">	Capabilities: [80] MSI: Enable+ Count&#x3D;1&#x2F;1 Maskable- 64bit-</span><br><span class="line">	Capabilities: [90] Subsystem: Intel Corporation Sunrise Point-H PCI Express Root Port</span><br><span class="line">	Capabilities: [a0] Power Management version 3</span><br><span class="line">	Capabilities: [100] Advanced Error Reporting</span><br><span class="line">	Capabilities: [140] Access Control Services</span><br><span class="line">	Capabilities: [200] L1 PM Substates</span><br><span class="line">	Capabilities: [220] #19</span><br><span class="line">	Kernel driver in use: pcieport</span><br><span class="line">	Kernel modules: shpchp</span><br><span class="line"></span><br><span class="line">00:1d.0 PCI bridge: Intel Corporation 100 Series&#x2F;C230 Series Chipset Family PCI Express Root Port #9 (rev f1) (prog-if 00 [Normal decode])</span><br><span class="line">	Flags: bus master, fast devsel, latency 0, IRQ 123</span><br><span class="line">	Bus: primary&#x3D;00, secondary&#x3D;03, subordinate&#x3D;03, sec-latency&#x3D;0</span><br><span class="line">	Memory behind bridge: dc000000-ddffffff</span><br><span class="line">	Capabilities: [40] Express Root Port (Slot+), MSI 00</span><br><span class="line">	Capabilities: [80] MSI: Enable+ Count&#x3D;1&#x2F;1 Maskable- 64bit-</span><br><span class="line">	Capabilities: [90] Subsystem: Intel Corporation Sunrise Point-H PCI Express Root Port</span><br><span class="line">	Capabilities: [a0] Power Management version 3</span><br><span class="line">	Capabilities: [100] Advanced Error Reporting</span><br><span class="line">	Capabilities: [140] Access Control Services</span><br><span class="line">	Capabilities: [200] L1 PM Substates</span><br><span class="line">	Capabilities: [220] #19</span><br><span class="line">	Kernel driver in use: pcieport</span><br><span class="line">	Kernel modules: shpchp</span><br><span class="line"></span><br><span class="line">00:1f.0 ISA bridge: Intel Corporation Q170 Chipset LPC&#x2F;eSPI Controller (rev 31)</span><br><span class="line">	Subsystem: Intel Corporation Sunrise Point-H LPC Controller</span><br><span class="line">	Flags: bus master, medium devsel, latency 0</span><br><span class="line"></span><br><span class="line">00:1f.2 Memory controller: Intel Corporation 100 Series&#x2F;C230 Series Chipset Family Power Management Controller (rev 31)</span><br><span class="line">	Subsystem: Intel Corporation Sunrise Point-H PMC</span><br><span class="line">	Flags: bus master, fast devsel, latency 0</span><br><span class="line">	Memory at df244000 (32-bit, non-prefetchable) [size&#x3D;16K]</span><br><span class="line"></span><br><span class="line">00:1f.3 Audio device: Intel Corporation 100 Series&#x2F;C230 Series Chipset Family HD Audio Controller (rev 31)</span><br><span class="line">	Subsystem: Advantech Co. Ltd Sunrise Point-H HD Audio</span><br><span class="line">	Flags: bus master, fast devsel, latency 32, IRQ 325</span><br><span class="line">	Memory at df240000 (64-bit, non-prefetchable) [size&#x3D;16K]</span><br><span class="line">	Memory at df220000 (64-bit, non-prefetchable) [size&#x3D;64K]</span><br><span class="line">	Capabilities: [50] Power Management version 3</span><br><span class="line">	Capabilities: [60] MSI: Enable+ Count&#x3D;1&#x2F;1 Maskable- 64bit+</span><br><span class="line">	Kernel driver in use: snd_hda_intel</span><br><span class="line">	Kernel modules: snd_hda_intel</span><br><span class="line"></span><br><span class="line">00:1f.4 SMBus: Intel Corporation 100 Series&#x2F;C230 Series Chipset Family SMBus (rev 31)</span><br><span class="line">	Subsystem: Intel Corporation Sunrise Point-H SMBus</span><br><span class="line">	Flags: medium devsel, IRQ 11</span><br><span class="line">	Memory at df24a000 (64-bit, non-prefetchable) [size&#x3D;256]</span><br><span class="line">	I&#x2F;O ports at f000 [size&#x3D;32]</span><br><span class="line">	Kernel modules: i2c_i801</span><br><span class="line"></span><br><span class="line">00:1f.6 Ethernet controller: Intel Corporation Ethernet Connection (2) I219-LM (rev 31)</span><br><span class="line">	Subsystem: Intel Corporation Ethernet Connection (2) I219-LM</span><br><span class="line">	Flags: bus master, fast devsel, latency 0, IRQ 318</span><br><span class="line">	Memory at df200000 (32-bit, non-prefetchable) [size&#x3D;128K]</span><br><span class="line">	Capabilities: [c8] Power Management version 3</span><br><span class="line">	Capabilities: [d0] MSI: Enable+ Count&#x3D;1&#x2F;1 Maskable- 64bit+</span><br><span class="line">	Capabilities: [e0] PCI Advanced Features</span><br><span class="line">	Kernel driver in use: e1000e</span><br><span class="line">	Kernel modules: e1000e</span><br><span class="line"></span><br><span class="line">01:00.0 VGA compatible controller: NVIDIA Corporation GP107 [GeForce GTX 1050 Ti] (rev a1) (prog-if 00 [VGA controller])</span><br><span class="line">	Subsystem: NVIDIA Corporation Device 11bf</span><br><span class="line">	Flags: bus master, fast devsel, latency 0, IRQ 326</span><br><span class="line">	Memory at de000000 (32-bit, non-prefetchable) [size&#x3D;16M]</span><br><span class="line">	Memory at c0000000 (64-bit, prefetchable) [size&#x3D;256M]</span><br><span class="line">	Memory at d0000000 (64-bit, prefetchable) [size&#x3D;32M]</span><br><span class="line">	I&#x2F;O ports at e000 [size&#x3D;128]</span><br><span class="line">	[virtual] Expansion ROM at 000c0000 [disabled] [size&#x3D;128K]</span><br><span class="line">	Capabilities: [60] Power Management version 3</span><br><span class="line">	Capabilities: [68] MSI: Enable+ Count&#x3D;1&#x2F;1 Maskable- 64bit+</span><br><span class="line">	Capabilities: [78] Express Legacy Endpoint, MSI 00</span><br><span class="line">	Capabilities: [100] Virtual Channel</span><br><span class="line">	Capabilities: [250] Latency Tolerance Reporting</span><br><span class="line">	Capabilities: [128] Power Budgeting &lt;?&gt;</span><br><span class="line">	Capabilities: [420] Advanced Error Reporting</span><br><span class="line">	Capabilities: [600] Vendor Specific Information: ID&#x3D;0001 Rev&#x3D;1 Len&#x3D;024 &lt;?&gt;</span><br><span class="line">	Capabilities: [900] #19</span><br><span class="line">	Kernel driver in use: nvidia</span><br><span class="line">	Kernel modules: nvidiafb, nouveau, nvidia_drm, nvidia</span><br><span class="line"></span><br><span class="line">01:00.1 Audio device: NVIDIA Corporation GP107GL High Definition Audio Controller (rev a1)</span><br><span class="line">	Subsystem: NVIDIA Corporation Device 11bf</span><br><span class="line">	Flags: bus master, fast devsel, latency 0, IRQ 17</span><br><span class="line">	Memory at df080000 (32-bit, non-prefetchable) [size&#x3D;16K]</span><br><span class="line">	Capabilities: [60] Power Management version 3</span><br><span class="line">	Capabilities: [68] MSI: Enable- Count&#x3D;1&#x2F;1 Maskable- 64bit+</span><br><span class="line">	Capabilities: [78] Express Endpoint, MSI 00</span><br><span class="line">	Capabilities: [100] Advanced Error Reporting</span><br><span class="line">	Kernel driver in use: snd_hda_intel</span><br><span class="line">	Kernel modules: snd_hda_intel</span><br><span class="line"></span><br><span class="line">02:00.0 Ethernet controller: Intel Corporation I211 Gigabit Network Connection (rev 03)</span><br><span class="line">	Subsystem: Intel Corporation I211 Gigabit Network Connection</span><br><span class="line">	Flags: bus master, fast devsel, latency 0, IRQ 17</span><br><span class="line">	Memory at df100000 (32-bit, non-prefetchable) [size&#x3D;128K]</span><br><span class="line">	I&#x2F;O ports at d000 [size&#x3D;32]</span><br><span class="line">	Memory at df120000 (32-bit, non-prefetchable) [size&#x3D;16K]</span><br><span class="line">	Capabilities: [40] Power Management version 3</span><br><span class="line">	Capabilities: [50] MSI: Enable- Count&#x3D;1&#x2F;1 Maskable+ 64bit+</span><br><span class="line">	Capabilities: [70] MSI-X: Enable+ Count&#x3D;5 Masked-</span><br><span class="line">	Capabilities: [a0] Express Endpoint, MSI 00</span><br><span class="line">	Capabilities: [100] Advanced Error Reporting</span><br><span class="line">	Capabilities: [140] Device Serial Number c4-00-ad-ff-ff-3a-e7-2d</span><br><span class="line">	Capabilities: [1a0] Transaction Processing Hints</span><br><span class="line">	Kernel driver in use: igb</span><br><span class="line">	Kernel modules: igb</span><br><span class="line"></span><br><span class="line">03:00.0 Memory controller: Xilinx Corporation Device 8034</span><br><span class="line">	Subsystem: Xilinx Corporation Device 0007</span><br><span class="line">	Flags: fast devsel, IRQ 11</span><br><span class="line">	Memory at dc000000 (32-bit, non-prefetchable) [disabled] [size&#x3D;32M]</span><br><span class="line">	Capabilities: [80] Power Management version 3</span><br><span class="line">	Capabilities: [90] MSI: Enable- Count&#x3D;1&#x2F;4 Maskable- 64bit+</span><br><span class="line">	Capabilities: [c0] Express Endpoint, MSI 00</span><br><span class="line">	Capabilities: [100] Advanced Error Reporting</span><br><span class="line">	Capabilities: [300] #19</span><br></pre></td></tr></table></figure>

<p>示例3：显示具体设备更详细的信息</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">~# lspci -vv -s 03:00.0</span><br><span class="line">03:00.0 Memory controller: Xilinx Corporation Device 8034</span><br><span class="line">	Subsystem: Xilinx Corporation Device 0007</span><br><span class="line">	Control: I&#x2F;O- Mem- BusMaster- SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx-</span><br><span class="line">	Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL&#x3D;fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR- INTx-</span><br><span class="line">	Interrupt: pin A routed to IRQ 11</span><br><span class="line">	Region 0: Memory at dc000000 (32-bit, non-prefetchable) [disabled] [size&#x3D;32M]</span><br><span class="line">	Capabilities: [80] Power Management version 3</span><br><span class="line">		Flags: PMEClk- DSI- D1- D2- AuxCurrent&#x3D;0mA PME(D0-,D1-,D2-,D3hot-,D3cold-)</span><br><span class="line">		Status: D0 NoSoftRst+ PME-Enable- DSel&#x3D;0 DScale&#x3D;0 PME-</span><br><span class="line">	Capabilities: [90] MSI: Enable- Count&#x3D;1&#x2F;4 Maskable- 64bit+</span><br><span class="line">		Address: 0000000000000000  Data: 0000</span><br><span class="line">	Capabilities: [c0] Express (v2) Endpoint, MSI 00</span><br><span class="line">		DevCap:	MaxPayload 512 bytes, PhantFunc 0, Latency L0s &lt;64ns, L1 &lt;1us</span><br><span class="line">			ExtTag- AttnBtn- AttnInd- PwrInd- RBE+ FLReset-</span><br><span class="line">		DevCtl:	Report errors: Correctable- Non-Fatal- Fatal- Unsupported-</span><br><span class="line">			RlxdOrd+ ExtTag- PhantFunc- AuxPwr- NoSnoop+</span><br><span class="line">			MaxPayload 256 bytes, MaxReadReq 512 bytes</span><br><span class="line">		DevSta:	CorrErr- UncorrErr- FatalErr- UnsuppReq- AuxPwr- TransPend-</span><br><span class="line">		LnkCap:	Port #0, Speed 8GT&#x2F;s, Width x4, ASPM not supported, Exit Latency L0s unlimited, L1 unlimited</span><br><span class="line">			ClockPM- Surprise- LLActRep- BwNot- ASPMOptComp+</span><br><span class="line">		LnkCtl:	ASPM Disabled; RCB 64 bytes Disabled- CommClk+</span><br><span class="line">			ExtSynch- ClockPM- AutWidDis- BWInt- AutBWInt-</span><br><span class="line">		LnkSta:	Speed 8GT&#x2F;s, Width x4, TrErr- Train- SlotClk+ DLActive- BWMgmt- ABWMgmt-</span><br><span class="line">		DevCap2: Completion Timeout: Range B, TimeoutDis+, LTR-, OBFF Not Supported</span><br><span class="line">		DevCtl2: Completion Timeout: 50us to 50ms, TimeoutDis-, LTR-, OBFF Disabled</span><br><span class="line">		LnkCtl2: Target Link Speed: 8GT&#x2F;s, EnterCompliance- SpeedDis-</span><br><span class="line">			 Transmit Margin: Normal Operating Range, EnterModifiedCompliance- ComplianceSOS-</span><br><span class="line">			 Compliance De-emphasis: -6dB</span><br><span class="line">		LnkSta2: Current De-emphasis Level: -3.5dB, EqualizationComplete+, EqualizationPhase1+</span><br><span class="line">			 EqualizationPhase2+, EqualizationPhase3+, LinkEqualizationRequest-</span><br><span class="line">	Capabilities: [100 v2] Advanced Error Reporting</span><br><span class="line">		UESta:	DLP- SDES- TLP- FCP- CmpltTO- CmpltAbrt- UnxCmplt- RxOF- MalfTLP- ECRC- UnsupReq- ACSViol-</span><br><span class="line">		UEMsk:	DLP- SDES- TLP- FCP- CmpltTO- CmpltAbrt- UnxCmplt- RxOF- MalfTLP- ECRC- UnsupReq- ACSViol-</span><br><span class="line">		UESvrt:	DLP+ SDES+ TLP- FCP+ CmpltTO- CmpltAbrt- UnxCmplt- RxOF+ MalfTLP+ ECRC- UnsupReq- ACSViol-</span><br><span class="line">		CESta:	RxErr- BadTLP- BadDLLP- Rollover- Timeout- NonFatalErr-</span><br><span class="line">		CEMsk:	RxErr- BadTLP- BadDLLP- Rollover- Timeout- NonFatalErr+</span><br><span class="line">		AERCap:	First Error Pointer: 00, GenCap- CGenEn- ChkCap- ChkEn-</span><br><span class="line">	Capabilities: [300 v1] #19</span><br></pre></td></tr></table></figure>

<p>示例4：显示具体设备的256byte配置空间</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">~# lspci -xxx -s 03:00.0</span><br><span class="line">03:00.0 Memory controller: Xilinx Corporation Device 8034</span><br><span class="line">00: ee 10 34 80 00 00 10 00 00 00 80 05 10 00 00 00</span><br><span class="line">10: 00 00 00 dc 00 00 00 00 00 00 00 00 00 00 00 00</span><br><span class="line">20: 00 00 00 00 00 00 00 00 00 00 00 00 ee 10 07 00</span><br><span class="line">30: 00 00 00 00 80 00 00 00 00 00 00 00 0b 01 00 00</span><br><span class="line">40: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</span><br><span class="line">50: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</span><br><span class="line">60: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</span><br><span class="line">70: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</span><br><span class="line">80: 01 90 03 00 08 00 00 00 00 00 00 00 00 00 00 00</span><br><span class="line">90: 05 c0 84 00 00 00 00 00 00 00 00 00 00 00 00 00</span><br><span class="line">a0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</span><br><span class="line">b0: 11 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</span><br><span class="line">c0: 10 00 02 00 02 80 e8 07 30 28 00 00 43 f0 43 00</span><br><span class="line">d0: 40 00 43 10 00 00 00 00 00 00 00 00 00 00 00 00</span><br><span class="line">e0: 00 00 00 00 12 00 00 00 00 00 00 00 0e 00 00 00</span><br><span class="line">f0: 03 00 1f 00 00 00 00 00 00 00 00 00 00 00 00 00</span><br></pre></td></tr></table></figure>

<p>示例5：显示总线树</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">root@ivus:~# lspci -tv</span><br><span class="line">-[0000:00]-+-00.0  Intel Corporation Xeon E3-1200 v6&#x2F;7th Gen Core Processor Host Bridge&#x2F;DRAM Registers</span><br><span class="line">           +-01.0-[01]--+-00.0  NVIDIA Corporation GP107 [GeForce GTX 1050 Ti]</span><br><span class="line">           |            \-00.1  NVIDIA Corporation GP107GL High Definition Audio Controller</span><br><span class="line">           +-08.0  Intel Corporation Xeon E3-1200 v5&#x2F;v6 &#x2F; E3-1500 v5 &#x2F; 6th&#x2F;7th Gen Core Processor Gaussian Mixture Model</span><br><span class="line">           +-14.0  Intel Corporation 100 Series&#x2F;C230 Series Chipset Family USB 3.0 xHCI Controller</span><br><span class="line">           +-14.2  Intel Corporation 100 Series&#x2F;C230 Series Chipset Family Thermal Subsystem</span><br><span class="line">           +-15.0  Intel Corporation 100 Series&#x2F;C230 Series Chipset Family Serial IO I2C Controller #0</span><br><span class="line">           +-15.1  Intel Corporation 100 Series&#x2F;C230 Series Chipset Family Serial IO I2C Controller #1</span><br><span class="line">           +-16.0  Intel Corporation 100 Series&#x2F;C230 Series Chipset Family MEI Controller #1</span><br><span class="line">           +-16.3  Intel Corporation 100 Series&#x2F;C230 Series Chipset Family KT Redirection</span><br><span class="line">           +-17.0  Intel Corporation Q170&#x2F;Q150&#x2F;B150&#x2F;H170&#x2F;H110&#x2F;Z170&#x2F;CM236 Chipset SATA Controller [AHCI Mode]</span><br><span class="line">           +-1c.0-[02]----00.0  Intel Corporation I211 Gigabit Network Connection</span><br><span class="line">           +-1d.0-[03]----00.0  Xilinx Corporation Device 8034</span><br><span class="line">           +-1f.0  Intel Corporation Q170 Chipset LPC&#x2F;eSPI Controller</span><br><span class="line">           +-1f.2  Intel Corporation 100 Series&#x2F;C230 Series Chipset Family Power Management Controller</span><br><span class="line">           +-1f.3  Intel Corporation 100 Series&#x2F;C230 Series Chipset Family HD Audio Controller</span><br><span class="line">           +-1f.4  Intel Corporation 100 Series&#x2F;C230 Series Chipset Family SMBus</span><br><span class="line">           \-1f.6  Intel Corporation Ethernet Connection (2) I219-LM</span><br></pre></td></tr></table></figure>

<p>示例6：查看厂家和设备号</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">~# lspci -n</span><br><span class="line">00:00.0 0600: 8086:591f (rev 05)</span><br><span class="line">00:01.0 0604: 8086:1901 (rev 05)</span><br><span class="line">00:08.0 0880: 8086:1911</span><br><span class="line">00:14.0 0c03: 8086:a12f (rev 31)</span><br><span class="line">00:14.2 1180: 8086:a131 (rev 31)</span><br><span class="line">00:15.0 1180: 8086:a160 (rev 31)</span><br><span class="line">00:15.1 1180: 8086:a161 (rev 31)</span><br><span class="line">00:16.0 0780: 8086:a13a (rev 31)</span><br><span class="line">00:16.3 0700: 8086:a13d (rev 31)</span><br><span class="line">00:17.0 0106: 8086:a102 (rev 31)</span><br><span class="line">00:1c.0 0604: 8086:a115 (rev f1)</span><br><span class="line">00:1d.0 0604: 8086:a118 (rev f1)</span><br><span class="line">00:1f.0 0601: 8086:a146 (rev 31)</span><br><span class="line">00:1f.2 0580: 8086:a121 (rev 31)</span><br><span class="line">00:1f.3 0403: 8086:a170 (rev 31)</span><br><span class="line">00:1f.4 0c05: 8086:a123 (rev 31)</span><br><span class="line">00:1f.6 0200: 8086:15b7 (rev 31)</span><br><span class="line">01:00.0 0300: 10de:1c82 (rev a1)</span><br><span class="line">01:00.1 0403: 10de:0fb9 (rev a1)</span><br><span class="line">02:00.0 0200: 8086:1539 (rev 03)</span><br><span class="line">03:00.0 0580: 10ee:8034</span><br></pre></td></tr></table></figure>

<p>解释最后一条信息的含义：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">03:00.0 0580: 10ee:8034</span><br></pre></td></tr></table></figure>

<p>03:00.0代表什么意思？</p>
<p>就是 bus number = 03 ,device number = 00 function = 0 </p>
<p>0580就是Class code</p>
<p>10ee就是厂家ID</p>
<p>8034就是设备ID</p>
<h2 id="其他操作"><a href="#其他操作" class="headerlink" title="其他操作"></a>其他操作</h2><h3 id="修改配置空间"><a href="#修改配置空间" class="headerlink" title="修改配置空间"></a>修改配置空间</h3><p>在应用层修改配置空间的命令为</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">setpci</span><br></pre></td></tr></table></figure>

<h3 id="扫描PCI设备"><a href="#扫描PCI设备" class="headerlink" title="扫描PCI设备"></a>扫描PCI设备</h3><p>探测PCI/PCIe设备的命令为</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">scanpci</span><br></pre></td></tr></table></figure>

<p>参考：</p>
<p><a href="http://ilinuxkernel.com/?p=166" target="_blank" rel="noopener">Linux PCI/PCI-E设备配置空间读取与修改</a></p>
]]></content>
      <categories>
        <category>linux</category>
        <category>Driver</category>
        <category>PCIe</category>
      </categories>
      <tags>
        <tag>PCIe</tag>
      </tags>
  </entry>
</search>
